2025-08-05 10:39:13 | INFO     | src.utils:_load_config:41 - Configuração carregada de config.yaml
2025-08-05 10:39:13 | INFO     | __main__:__init__:41 - Sistema de detecção de fraude inicializado
2025-08-05 10:39:13 | INFO     | __main__:__init__:42 - Dispositivo: cpu
2025-08-05 10:39:13 | INFO     | __main__:run_full_pipeline:134 - Iniciando pipeline completo de detecção de fraude
2025-08-05 10:39:13 | INFO     | __main__:run_full_pipeline:140 - Etapa 1: Carregamento e processamento de dados
2025-08-05 10:39:13 | INFO     | __main__:setup_data_pipeline:49 - Pipeline de dados configurado
2025-08-05 10:39:13 | INFO     | src.utils:__exit__:322 - Configuração do pipeline de dados executado em 0.00s
2025-08-05 10:39:13 | INFO     | src.data:load_data:53 - Carregando dados de transação...
2025-08-05 10:39:13 | INFO     | src.utils:__exit__:322 - Carregamento de dados executado em 0.00s
2025-08-05 10:39:13 | INFO     | src.utils:__exit__:322 - Pipeline completo de dados executado em 0.00s
2025-08-05 10:39:13 | ERROR    | __main__:run_full_pipeline:162 - Erro no pipeline: [Errno 20] Not a directory: 'ieee-fraud-detection/train_transaction.csv/train_transaction.csv'
2025-08-05 10:39:13 | ERROR    | __main__:main:310 - Erro na execução: [Errno 20] Not a directory: 'ieee-fraud-detection/train_transaction.csv/train_transaction.csv'
2025-08-05 10:57:26 | INFO     | src.utils:_load_config:41 - Configuração carregada de config.yaml
2025-08-05 10:57:26 | INFO     | main:__init__:41 - Sistema de detecção de fraude inicializado
2025-08-05 10:57:26 | INFO     | main:__init__:42 - Dispositivo: cpu
2025-08-05 10:57:26 | INFO     | main:run_full_pipeline:134 - Iniciando pipeline completo de detecção de fraude
2025-08-05 10:57:26 | INFO     | main:run_full_pipeline:140 - Etapa 1: Carregamento e processamento de dados
2025-08-05 10:57:26 | INFO     | main:setup_data_pipeline:49 - Pipeline de dados configurado
2025-08-05 10:57:26 | INFO     | src.utils:__exit__:322 - Configuração do pipeline de dados executado em 0.00s
2025-08-05 10:57:26 | INFO     | src.data:load_data:53 - Carregando dados de transação...
2025-08-05 10:57:26 | INFO     | src.utils:__exit__:322 - Carregamento de dados executado em 0.00s
2025-08-05 10:57:26 | INFO     | src.utils:__exit__:322 - Pipeline completo de dados executado em 0.00s
2025-08-05 10:57:26 | ERROR    | main:run_full_pipeline:162 - Erro no pipeline: [Errno 20] Not a directory: 'ieee-fraud-detection/train_transaction.csv/train_transaction.csv'
2025-08-05 11:09:56 | INFO     | src.utils:_load_config:41 - Configuração carregada de config.yaml
2025-08-05 11:09:56 | INFO     | main:__init__:41 - Sistema de detecção de fraude inicializado
2025-08-05 11:09:56 | INFO     | main:__init__:42 - Dispositivo: cpu
2025-08-05 11:09:56 | INFO     | main:run_full_pipeline:135 - Iniciando pipeline completo de detecção de fraude
2025-08-05 11:09:56 | INFO     | main:run_full_pipeline:141 - Etapa 1: Carregamento e processamento de dados
2025-08-05 11:09:56 | INFO     | main:setup_data_pipeline:50 - Pipeline de dados configurado
2025-08-05 11:09:56 | INFO     | src.utils:__exit__:322 - Configuração do pipeline de dados executado em 0.00s
2025-08-05 11:09:56 | INFO     | src.data:load_data:53 - Carregando dados de transação...
2025-08-05 11:09:56 | INFO     | src.data:load_data:65 - Carregando dados de identidade...
2025-08-05 11:09:56 | INFO     | src.data:load_data:80 - Dados carregados - Treino: 1000, Teste: 1000
2025-08-05 11:09:56 | INFO     | src.utils:__exit__:322 - Carregamento de dados executado em 0.05s
2025-08-05 11:09:56 | INFO     | src.utils:__exit__:322 - Engenharia de features executado em 0.01s
2025-08-05 11:09:56 | INFO     | src.utils:__exit__:322 - Pipeline completo de dados executado em 0.06s
2025-08-05 11:09:56 | ERROR    | main:run_full_pipeline:163 - Erro no pipeline: 'TransactionAMT'
2025-08-05 11:11:06 | INFO     | src.utils:_load_config:41 - Configuração carregada de config.yaml
2025-08-05 11:11:06 | INFO     | main:__init__:41 - Sistema de detecção de fraude inicializado
2025-08-05 11:11:06 | INFO     | main:__init__:42 - Dispositivo: cpu
2025-08-05 11:11:06 | INFO     | main:run_full_pipeline:135 - Iniciando pipeline completo de detecção de fraude
2025-08-05 11:11:06 | INFO     | main:run_full_pipeline:141 - Etapa 1: Carregamento e processamento de dados
2025-08-05 11:11:06 | INFO     | main:setup_data_pipeline:50 - Pipeline de dados configurado
2025-08-05 11:11:06 | INFO     | src.utils:__exit__:322 - Configuração do pipeline de dados executado em 0.00s
2025-08-05 11:11:06 | INFO     | src.data:load_data:53 - Carregando dados de transação...
2025-08-05 11:11:06 | INFO     | src.data:load_data:65 - Carregando dados de identidade...
2025-08-05 11:11:06 | INFO     | src.data:load_data:80 - Dados carregados - Treino: 1000, Teste: 1000
2025-08-05 11:11:06 | INFO     | src.utils:__exit__:322 - Carregamento de dados executado em 0.05s
2025-08-05 11:11:06 | INFO     | src.data:engineer_features:168 - Features processadas: 448 colunas
2025-08-05 11:11:06 | INFO     | src.utils:__exit__:322 - Engenharia de features executado em 0.16s
2025-08-05 11:11:06 | INFO     | src.utils:__exit__:322 - Engenharia de features executado em 0.09s
2025-08-05 11:11:06 | INFO     | src.utils:__exit__:322 - Pipeline completo de dados executado em 0.30s
2025-08-05 11:11:06 | ERROR    | main:run_full_pipeline:163 - Erro no pipeline: The feature names should match those that were passed during fit.
Feature names unseen at fit time:
- id-01
- id-02
- id-03
- id-04
- id-05
- ...
Feature names seen at fit time, yet now missing:
- id_01
- id_02
- id_03
- id_04
- id_05
- ...

2025-08-05 11:12:37 | INFO     | src.utils:_load_config:41 - Configuração carregada de config.yaml
2025-08-05 11:12:37 | INFO     | main:__init__:41 - Sistema de detecção de fraude inicializado
2025-08-05 11:12:37 | INFO     | main:__init__:42 - Dispositivo: cpu
2025-08-05 11:12:37 | INFO     | main:run_full_pipeline:135 - Iniciando pipeline completo de detecção de fraude
2025-08-05 11:12:37 | INFO     | main:run_full_pipeline:141 - Etapa 1: Carregamento e processamento de dados
2025-08-05 11:12:37 | INFO     | main:setup_data_pipeline:50 - Pipeline de dados configurado
2025-08-05 11:12:37 | INFO     | src.utils:__exit__:322 - Configuração do pipeline de dados executado em 0.00s
2025-08-05 11:12:37 | INFO     | src.data:load_data:67 - Carregando dados de transação...
2025-08-05 11:12:37 | INFO     | src.data:load_data:81 - Carregando dados de identidade...
2025-08-05 11:12:37 | INFO     | src.data:load_data:98 - Dados carregados - Treino: 1000, Teste: 1000
2025-08-05 11:12:37 | INFO     | src.utils:__exit__:322 - Carregamento de dados executado em 0.13s
2025-08-05 11:12:37 | INFO     | src.data:engineer_features:186 - Features processadas: 448 colunas
2025-08-05 11:12:37 | INFO     | src.utils:__exit__:322 - Engenharia de features executado em 0.16s
2025-08-05 11:12:37 | INFO     | src.data:engineer_features:186 - Features processadas: 447 colunas
2025-08-05 11:12:37 | INFO     | src.utils:__exit__:322 - Engenharia de features executado em 0.16s
2025-08-05 11:12:37 | INFO     | src.utils:__exit__:322 - Construção do grafo executado em 0.01s
2025-08-05 11:12:37 | INFO     | src.utils:__exit__:322 - Pipeline completo de dados executado em 0.45s
2025-08-05 11:12:37 | ERROR    | main:run_full_pipeline:163 - Erro no pipeline: 9.183612653337166e+18
2025-08-05 11:15:51 | INFO     | src.utils:_load_config:41 - Configuração carregada de config.yaml
2025-08-05 11:15:51 | INFO     | main:__init__:41 - Sistema de detecção de fraude inicializado
2025-08-05 11:15:51 | INFO     | main:__init__:42 - Dispositivo: cpu
2025-08-05 11:15:51 | INFO     | main:run_full_pipeline:135 - Iniciando pipeline completo de detecção de fraude
2025-08-05 11:15:51 | INFO     | main:run_full_pipeline:141 - Etapa 1: Carregamento e processamento de dados
2025-08-05 11:15:51 | INFO     | main:setup_data_pipeline:50 - Pipeline de dados configurado
2025-08-05 11:15:51 | INFO     | src.utils:__exit__:322 - Configuração do pipeline de dados executado em 0.00s
2025-08-05 11:15:51 | INFO     | src.data:load_data:88 - Carregando dados de transação...
2025-08-05 11:15:51 | INFO     | src.data:load_data:102 - Carregando dados de identidade...
2025-08-05 11:15:51 | INFO     | src.data:load_data:119 - Dados carregados - Treino: 1000, Teste: 1000
2025-08-05 11:15:51 | INFO     | src.utils:__exit__:322 - Carregamento de dados executado em 0.14s
2025-08-05 11:15:51 | INFO     | src.data:engineer_features:207 - Features processadas: 448 colunas
2025-08-05 11:15:51 | INFO     | src.utils:__exit__:322 - Engenharia de features executado em 0.17s
2025-08-05 11:15:51 | INFO     | src.data:engineer_features:207 - Features processadas: 447 colunas
2025-08-05 11:15:51 | INFO     | src.utils:__exit__:322 - Engenharia de features executado em 0.16s
2025-08-05 11:15:51 | INFO     | src.data:build_heterogeneous_graph:385 - Grafo criado com 1747 nós
2025-08-05 11:15:51 | INFO     | src.data:build_heterogeneous_graph:386 - Tipos de nós: ['transaction', 'user', 'card', 'device']
2025-08-05 11:15:51 | INFO     | src.data:build_heterogeneous_graph:387 - Tipos de arestas: [('user', 'makes', 'transaction'), ('transaction', 'uses', 'card'), ('transaction', 'from', 'device')]
2025-08-05 11:15:51 | INFO     | src.utils:__exit__:322 - Construção do grafo executado em 0.05s
2025-08-05 11:15:51 | INFO     | src.data:build_heterogeneous_graph:385 - Grafo criado com 1728 nós
2025-08-05 11:15:51 | INFO     | src.data:build_heterogeneous_graph:386 - Tipos de nós: ['transaction', 'user', 'card', 'device']
2025-08-05 11:15:51 | INFO     | src.data:build_heterogeneous_graph:387 - Tipos de arestas: [('user', 'makes', 'transaction'), ('transaction', 'uses', 'card'), ('transaction', 'from', 'device')]
2025-08-05 11:15:51 | INFO     | src.utils:__exit__:322 - Construção do grafo executado em 0.05s
2025-08-05 11:15:51 | INFO     | src.utils:__exit__:322 - Pipeline completo de dados executado em 0.57s
2025-08-05 11:15:51 | INFO     | main:load_and_process_data:64 - Dados processados: {'loader_info': {'transaction_train_shape': (1000, 394), 'transaction_test_shape': (1000, 393), 'identity_train_shape': (1000, 41), 'identity_test_shape': (1000, 41), 'fraud_rate': 0.015, 'missing_values': 159304}, 'train_graph': {'node_types': ['transaction', 'user', 'card', 'device'], 'edge_types': [('user', 'makes', 'transaction'), ('transaction', 'uses', 'card'), ('transaction', 'from', 'device')], 'num_transaction_nodes': 1000, 'num_features': 443, 'fraud_rate': 0.014999999664723873}}
2025-08-05 11:15:51 | INFO     | main:run_full_pipeline:146 - Etapa 2: Criação do modelo
2025-08-05 11:15:51 | INFO     | src.utils:__exit__:322 - Criação do modelo executado em 0.00s
2025-08-05 11:15:51 | ERROR    | main:run_full_pipeline:163 - Erro no pipeline: src.models.ModelFactory.create_model() got multiple values for keyword argument 'hidden_dim'
2025-08-05 11:18:32 | INFO     | src.utils:_load_config:41 - Configuração carregada de config.yaml
2025-08-05 11:18:32 | INFO     | main:__init__:41 - Sistema de detecção de fraude inicializado
2025-08-05 11:18:32 | INFO     | main:__init__:42 - Dispositivo: cpu
2025-08-05 11:18:32 | INFO     | main:run_full_pipeline:141 - Iniciando pipeline completo de detecção de fraude
2025-08-05 11:18:32 | INFO     | main:run_full_pipeline:147 - Etapa 1: Carregamento e processamento de dados
2025-08-05 11:18:32 | INFO     | main:setup_data_pipeline:50 - Pipeline de dados configurado
2025-08-05 11:18:32 | INFO     | src.utils:__exit__:322 - Configuração do pipeline de dados executado em 0.00s
2025-08-05 11:18:32 | INFO     | src.data:load_data:88 - Carregando dados de transação...
2025-08-05 11:18:32 | INFO     | src.data:load_data:102 - Carregando dados de identidade...
2025-08-05 11:18:32 | INFO     | src.data:load_data:119 - Dados carregados - Treino: 1000, Teste: 1000
2025-08-05 11:18:32 | INFO     | src.utils:__exit__:322 - Carregamento de dados executado em 0.05s
2025-08-05 11:18:33 | INFO     | src.data:engineer_features:207 - Features processadas: 448 colunas
2025-08-05 11:18:33 | INFO     | src.utils:__exit__:322 - Engenharia de features executado em 0.16s
2025-08-05 11:18:33 | INFO     | src.data:engineer_features:207 - Features processadas: 447 colunas
2025-08-05 11:18:33 | INFO     | src.utils:__exit__:322 - Engenharia de features executado em 0.16s
2025-08-05 11:18:33 | INFO     | src.data:build_heterogeneous_graph:385 - Grafo criado com 1747 nós
2025-08-05 11:18:33 | INFO     | src.data:build_heterogeneous_graph:386 - Tipos de nós: ['transaction', 'user', 'card', 'device']
2025-08-05 11:18:33 | INFO     | src.data:build_heterogeneous_graph:387 - Tipos de arestas: [('user', 'makes', 'transaction'), ('transaction', 'uses', 'card'), ('transaction', 'from', 'device')]
2025-08-05 11:18:33 | INFO     | src.utils:__exit__:322 - Construção do grafo executado em 0.06s
2025-08-05 11:18:33 | INFO     | src.data:build_heterogeneous_graph:385 - Grafo criado com 1728 nós
2025-08-05 11:18:33 | INFO     | src.data:build_heterogeneous_graph:386 - Tipos de nós: ['transaction', 'user', 'card', 'device']
2025-08-05 11:18:33 | INFO     | src.data:build_heterogeneous_graph:387 - Tipos de arestas: [('user', 'makes', 'transaction'), ('transaction', 'uses', 'card'), ('transaction', 'from', 'device')]
2025-08-05 11:18:33 | INFO     | src.utils:__exit__:322 - Construção do grafo executado em 0.05s
2025-08-05 11:18:33 | INFO     | src.utils:__exit__:322 - Pipeline completo de dados executado em 0.48s
2025-08-05 11:18:33 | INFO     | main:load_and_process_data:64 - Dados processados: {'loader_info': {'transaction_train_shape': (1000, 394), 'transaction_test_shape': (1000, 393), 'identity_train_shape': (1000, 41), 'identity_test_shape': (1000, 41), 'fraud_rate': 0.015, 'missing_values': 159304}, 'train_graph': {'node_types': ['transaction', 'user', 'card', 'device'], 'edge_types': [('user', 'makes', 'transaction'), ('transaction', 'uses', 'card'), ('transaction', 'from', 'device')], 'num_transaction_nodes': 1000, 'num_features': 443, 'fraud_rate': 0.014999999664723873}}
2025-08-05 11:18:33 | INFO     | main:run_full_pipeline:152 - Etapa 2: Criação do modelo
2025-08-05 11:18:33 | INFO     | src.models:_build_model:132 - GraphSAGE construído: 3 camadas, dim oculta: 256, agregação: mean
2025-08-05 11:18:33 | INFO     | main:create_model:96 - Modelo criado: GraphSAGEModel
2025-08-05 11:18:33 | INFO     | main:create_model:97 - Parâmetros: 524,418
2025-08-05 11:18:33 | INFO     | src.utils:__exit__:322 - Criação do modelo executado em 0.03s
2025-08-05 11:18:33 | INFO     | main:run_full_pipeline:157 - Etapa 3: Treinamento do modelo
2025-08-05 11:18:33 | INFO     | src.utils:__exit__:322 - Treinamento do modelo executado em 0.00s
2025-08-05 11:18:33 | ERROR    | main:run_full_pipeline:169 - Erro no pipeline: '<=' not supported between instances of 'float' and 'str'
2025-08-05 11:23:34 | INFO     | src.utils:_load_config:41 - Configuração carregada de config.yaml
2025-08-05 11:23:34 | INFO     | main:__init__:41 - Sistema de detecção de fraude inicializado
2025-08-05 11:23:34 | INFO     | main:__init__:42 - Dispositivo: cpu
2025-08-05 11:26:13 | INFO     | src.utils:_load_config:41 - Configuração carregada de config.yaml
2025-08-05 11:26:13 | INFO     | main:__init__:41 - Sistema de detecção de fraude inicializado
2025-08-05 11:26:13 | INFO     | main:__init__:42 - Dispositivo: cpu
2025-08-05 11:26:13 | INFO     | main:run_full_pipeline:141 - Iniciando pipeline completo de detecção de fraude
2025-08-05 11:26:13 | INFO     | main:run_full_pipeline:147 - Etapa 1: Carregamento e processamento de dados
2025-08-05 11:26:13 | INFO     | main:setup_data_pipeline:50 - Pipeline de dados configurado
2025-08-05 11:26:13 | INFO     | src.utils:__exit__:322 - Configuração do pipeline de dados executado em 0.00s
2025-08-05 11:26:13 | INFO     | src.data:load_data:88 - Carregando dados de transação...
2025-08-05 11:26:13 | INFO     | src.data:load_data:102 - Carregando dados de identidade...
2025-08-05 11:26:13 | INFO     | src.data:load_data:119 - Dados carregados - Treino: 1000, Teste: 1000
2025-08-05 11:26:13 | INFO     | src.utils:__exit__:322 - Carregamento de dados executado em 0.05s
2025-08-05 11:26:13 | INFO     | src.data:engineer_features:207 - Features processadas: 448 colunas
2025-08-05 11:26:13 | INFO     | src.utils:__exit__:322 - Engenharia de features executado em 0.17s
2025-08-05 11:26:13 | INFO     | src.data:engineer_features:207 - Features processadas: 447 colunas
2025-08-05 11:26:13 | INFO     | src.utils:__exit__:322 - Engenharia de features executado em 0.16s
2025-08-05 11:26:13 | INFO     | src.data:build_heterogeneous_graph:385 - Grafo criado com 1747 nós
2025-08-05 11:26:13 | INFO     | src.data:build_heterogeneous_graph:386 - Tipos de nós: ['transaction', 'user', 'card', 'device']
2025-08-05 11:26:13 | INFO     | src.data:build_heterogeneous_graph:387 - Tipos de arestas: [('user', 'makes', 'transaction'), ('transaction', 'uses', 'card'), ('transaction', 'from', 'device')]
2025-08-05 11:26:13 | INFO     | src.utils:__exit__:322 - Construção do grafo executado em 0.05s
2025-08-05 11:26:13 | INFO     | src.data:build_heterogeneous_graph:385 - Grafo criado com 1728 nós
2025-08-05 11:26:13 | INFO     | src.data:build_heterogeneous_graph:386 - Tipos de nós: ['transaction', 'user', 'card', 'device']
2025-08-05 11:26:13 | INFO     | src.data:build_heterogeneous_graph:387 - Tipos de arestas: [('user', 'makes', 'transaction'), ('transaction', 'uses', 'card'), ('transaction', 'from', 'device')]
2025-08-05 11:26:13 | INFO     | src.utils:__exit__:322 - Construção do grafo executado em 0.05s
2025-08-05 11:26:13 | INFO     | src.utils:__exit__:322 - Pipeline completo de dados executado em 0.49s
2025-08-05 11:26:13 | INFO     | main:load_and_process_data:64 - Dados processados: {'loader_info': {'transaction_train_shape': (1000, 394), 'transaction_test_shape': (1000, 393), 'identity_train_shape': (1000, 41), 'identity_test_shape': (1000, 41), 'fraud_rate': 0.015, 'missing_values': 159304}, 'train_graph': {'node_types': ['transaction', 'user', 'card', 'device'], 'edge_types': [('user', 'makes', 'transaction'), ('transaction', 'uses', 'card'), ('transaction', 'from', 'device')], 'num_transaction_nodes': 1000, 'num_features': 443, 'fraud_rate': 0.014999999664723873}}
2025-08-05 11:26:13 | INFO     | main:run_full_pipeline:152 - Etapa 2: Criação do modelo
2025-08-05 11:26:13 | INFO     | src.models:_build_model:132 - GraphSAGE construído: 3 camadas, dim oculta: 256, agregação: mean
2025-08-05 11:26:13 | INFO     | main:create_model:96 - Modelo criado: GraphSAGEModel
2025-08-05 11:26:13 | INFO     | main:create_model:97 - Parâmetros: 524,418
2025-08-05 11:26:13 | INFO     | src.utils:__exit__:322 - Criação do modelo executado em 0.02s
2025-08-05 11:26:13 | INFO     | main:run_full_pipeline:157 - Etapa 3: Treinamento do modelo
2025-08-05 11:26:13 | INFO     | src.utils:__exit__:322 - Treinamento do modelo executado em 0.00s
2025-08-05 11:26:13 | ERROR    | main:run_full_pipeline:169 - Erro no pipeline: '<=' not supported between instances of 'float' and 'str'
2025-08-05 11:26:24 | INFO     | src.utils:_load_config:41 - Configuração carregada de config.yaml
2025-08-05 11:26:24 | INFO     | main:__init__:41 - Sistema de detecção de fraude inicializado
2025-08-05 11:26:24 | INFO     | main:__init__:42 - Dispositivo: cpu
2025-08-05 11:26:24 | INFO     | main:setup_data_pipeline:50 - Pipeline de dados configurado
2025-08-05 11:26:24 | INFO     | src.utils:__exit__:322 - Configuração do pipeline de dados executado em 0.00s
2025-08-05 11:26:24 | INFO     | src.data:load_data:88 - Carregando dados de transação...
2025-08-05 11:26:24 | INFO     | src.data:load_data:102 - Carregando dados de identidade...
2025-08-05 11:26:24 | INFO     | src.data:load_data:119 - Dados carregados - Treino: 100, Teste: 100
2025-08-05 11:26:24 | INFO     | src.utils:__exit__:322 - Carregamento de dados executado em 0.02s
2025-08-05 11:26:24 | INFO     | src.data:engineer_features:207 - Features processadas: 448 colunas
2025-08-05 11:26:24 | INFO     | src.utils:__exit__:322 - Engenharia de features executado em 0.09s
2025-08-05 11:26:24 | INFO     | src.data:engineer_features:207 - Features processadas: 447 colunas
2025-08-05 11:26:24 | INFO     | src.utils:__exit__:322 - Engenharia de features executado em 0.10s
2025-08-05 11:26:24 | INFO     | src.data:build_heterogeneous_graph:385 - Grafo criado com 253 nós
2025-08-05 11:26:24 | INFO     | src.data:build_heterogeneous_graph:386 - Tipos de nós: ['transaction', 'user', 'card', 'device']
2025-08-05 11:26:24 | INFO     | src.data:build_heterogeneous_graph:387 - Tipos de arestas: [('user', 'makes', 'transaction'), ('transaction', 'uses', 'card'), ('transaction', 'from', 'device')]
2025-08-05 11:26:24 | INFO     | src.utils:__exit__:322 - Construção do grafo executado em 0.01s
2025-08-05 11:26:24 | INFO     | src.data:build_heterogeneous_graph:385 - Grafo criado com 231 nós
2025-08-05 11:26:24 | INFO     | src.data:build_heterogeneous_graph:386 - Tipos de nós: ['transaction', 'user', 'card', 'device']
2025-08-05 11:26:24 | INFO     | src.data:build_heterogeneous_graph:387 - Tipos de arestas: [('user', 'makes', 'transaction'), ('transaction', 'uses', 'card'), ('transaction', 'from', 'device')]
2025-08-05 11:26:24 | INFO     | src.utils:__exit__:322 - Construção do grafo executado em 0.02s
2025-08-05 11:26:24 | INFO     | src.utils:__exit__:322 - Pipeline completo de dados executado em 0.25s
2025-08-05 11:26:24 | INFO     | main:load_and_process_data:64 - Dados processados: {'loader_info': {'transaction_train_shape': (100, 394), 'transaction_test_shape': (100, 393), 'identity_train_shape': (100, 41), 'identity_test_shape': (100, 41), 'fraud_rate': 0.0, 'missing_values': 16517}, 'train_graph': {'node_types': ['transaction', 'user', 'card', 'device'], 'edge_types': [('user', 'makes', 'transaction'), ('transaction', 'uses', 'card'), ('transaction', 'from', 'device')], 'num_transaction_nodes': 100, 'num_features': 443, 'fraud_rate': 0.0}}
2025-08-05 11:35:57 | INFO     | src.utils:_load_config:41 - Configuração carregada de config.yaml
2025-08-05 11:35:57 | INFO     | main:__init__:41 - Sistema de detecção de fraude inicializado
2025-08-05 11:35:57 | INFO     | main:__init__:42 - Dispositivo: cpu
2025-08-05 11:35:57 | INFO     | main:run_full_pipeline:141 - Iniciando pipeline completo de detecção de fraude
2025-08-05 11:35:57 | INFO     | main:run_full_pipeline:147 - Etapa 1: Carregamento e processamento de dados
2025-08-05 11:35:57 | INFO     | main:setup_data_pipeline:50 - Pipeline de dados configurado
2025-08-05 11:35:57 | INFO     | src.utils:__exit__:322 - Configuração do pipeline de dados executado em 0.00s
2025-08-05 11:35:57 | INFO     | src.data:load_data:88 - Carregando dados de transação...
2025-08-05 11:35:58 | INFO     | src.data:load_data:102 - Carregando dados de identidade...
2025-08-05 11:35:58 | INFO     | src.data:load_data:119 - Dados carregados - Treino: 1000, Teste: 1000
2025-08-05 11:35:58 | INFO     | src.utils:__exit__:322 - Carregamento de dados executado em 0.13s
2025-08-05 11:35:58 | INFO     | src.data:engineer_features:210 - Features processadas: 448 colunas
2025-08-05 11:35:58 | INFO     | src.utils:__exit__:322 - Engenharia de features executado em 0.20s
2025-08-05 11:35:58 | INFO     | src.data:engineer_features:210 - Features processadas: 447 colunas
2025-08-05 11:35:58 | INFO     | src.utils:__exit__:322 - Engenharia de features executado em 0.19s
2025-08-05 11:35:58 | INFO     | src.data:build_heterogeneous_graph:424 - Grafo criado com 1504 nós
2025-08-05 11:35:58 | INFO     | src.data:build_heterogeneous_graph:425 - Tipos de nós: ['transaction', 'user', 'card', 'device']
2025-08-05 11:35:58 | INFO     | src.data:build_heterogeneous_graph:426 - Tipos de arestas: [('user', 'makes', 'transaction'), ('transaction', 'uses', 'card'), ('transaction', 'from', 'device')]
2025-08-05 11:35:58 | INFO     | src.utils:__exit__:322 - Construção do grafo executado em 0.05s
2025-08-05 11:35:58 | INFO     | src.data:build_heterogeneous_graph:424 - Grafo criado com 1520 nós
2025-08-05 11:35:58 | INFO     | src.data:build_heterogeneous_graph:425 - Tipos de nós: ['transaction', 'user', 'card', 'device']
2025-08-05 11:35:58 | INFO     | src.data:build_heterogeneous_graph:426 - Tipos de arestas: [('user', 'makes', 'transaction'), ('transaction', 'uses', 'card'), ('transaction', 'from', 'device')]
2025-08-05 11:35:58 | INFO     | src.utils:__exit__:322 - Construção do grafo executado em 0.05s
2025-08-05 11:35:58 | INFO     | src.utils:__exit__:322 - Pipeline completo de dados executado em 0.61s
2025-08-05 11:35:58 | INFO     | main:load_and_process_data:64 - Dados processados: {'loader_info': {'transaction_train_shape': (1000, 394), 'transaction_test_shape': (1000, 393), 'identity_train_shape': (1000, 41), 'identity_test_shape': (1000, 41), 'fraud_rate': 0.015, 'missing_values': 159304}, 'train_graph': {'node_types': ['transaction', 'user', 'card', 'device'], 'edge_types': [('user', 'makes', 'transaction'), ('transaction', 'uses', 'card'), ('transaction', 'from', 'device')], 'num_transaction_nodes': 1000, 'num_features': 443, 'fraud_rate': 0.014999999664723873}}
2025-08-05 11:35:58 | INFO     | main:run_full_pipeline:152 - Etapa 2: Criação do modelo
2025-08-05 11:35:58 | INFO     | src.models:_build_model:132 - GraphSAGE construído: 3 camadas, dim oculta: 256, agregação: mean
2025-08-05 11:35:58 | INFO     | main:create_model:96 - Modelo criado: GraphSAGEModel
2025-08-05 11:35:58 | INFO     | main:create_model:97 - Parâmetros: 524,418
2025-08-05 11:35:58 | INFO     | src.utils:__exit__:322 - Criação do modelo executado em 0.02s
2025-08-05 11:35:58 | INFO     | main:run_full_pipeline:157 - Etapa 3: Treinamento do modelo
2025-08-05 11:35:58 | INFO     | src.utils:__exit__:322 - Treinamento do modelo executado em 0.00s
2025-08-05 11:35:58 | ERROR    | main:run_full_pipeline:169 - Erro no pipeline: '<=' not supported between instances of 'float' and 'str'
2025-08-05 11:39:21 | INFO     | src.data:load_data:88 - Carregando dados de transação...
2025-08-05 11:39:21 | INFO     | src.data:load_data:102 - Carregando dados de identidade...
2025-08-05 11:39:21 | INFO     | src.data:load_data:119 - Dados carregados - Treino: 50, Teste: 50
2025-08-05 11:39:21 | INFO     | src.utils:__exit__:322 - Carregamento de dados executado em 0.02s
2025-08-05 11:39:21 | INFO     | src.data:engineer_features:210 - Features processadas: 448 colunas
2025-08-05 11:39:21 | INFO     | src.utils:__exit__:322 - Engenharia de features executado em 0.13s
2025-08-05 11:39:21 | INFO     | src.data:engineer_features:210 - Features processadas: 447 colunas
2025-08-05 11:39:21 | INFO     | src.utils:__exit__:322 - Engenharia de features executado em 0.12s
2025-08-05 11:39:21 | INFO     | src.data:build_heterogeneous_graph:424 - Grafo criado com 119 nós
2025-08-05 11:39:21 | INFO     | src.data:build_heterogeneous_graph:425 - Tipos de nós: ['transaction', 'user', 'card', 'device']
2025-08-05 11:39:21 | INFO     | src.data:build_heterogeneous_graph:426 - Tipos de arestas: [('user', 'makes', 'transaction'), ('transaction', 'uses', 'card'), ('transaction', 'from', 'device')]
2025-08-05 11:39:21 | INFO     | src.utils:__exit__:322 - Construção do grafo executado em 0.01s
2025-08-05 11:39:21 | INFO     | src.data:build_heterogeneous_graph:424 - Grafo criado com 113 nós
2025-08-05 11:39:21 | INFO     | src.data:build_heterogeneous_graph:425 - Tipos de nós: ['transaction', 'user', 'card', 'device']
2025-08-05 11:39:21 | INFO     | src.data:build_heterogeneous_graph:426 - Tipos de arestas: [('user', 'makes', 'transaction'), ('transaction', 'uses', 'card'), ('transaction', 'from', 'device')]
2025-08-05 11:39:21 | INFO     | src.utils:__exit__:322 - Construção do grafo executado em 0.01s
2025-08-05 11:39:21 | INFO     | src.utils:__exit__:322 - Pipeline completo de dados executado em 0.28s
2025-08-05 11:42:39 | INFO     | src.utils:_load_config:41 - Configuração carregada de config.yaml
2025-08-05 11:42:39 | INFO     | main:__init__:41 - Sistema de detecção de fraude inicializado
2025-08-05 11:42:39 | INFO     | main:__init__:42 - Dispositivo: cpu
2025-08-05 11:42:39 | INFO     | main:run_full_pipeline:141 - Iniciando pipeline completo de detecção de fraude
2025-08-05 11:42:39 | INFO     | main:run_full_pipeline:147 - Etapa 1: Carregamento e processamento de dados
2025-08-05 11:42:39 | INFO     | main:setup_data_pipeline:50 - Pipeline de dados configurado
2025-08-05 11:42:39 | INFO     | src.utils:__exit__:322 - Configuração do pipeline de dados executado em 0.00s
2025-08-05 11:42:39 | INFO     | src.data:load_data:88 - Carregando dados de transação...
2025-08-05 11:42:39 | INFO     | src.data:load_data:102 - Carregando dados de identidade...
2025-08-05 11:42:39 | INFO     | src.data:load_data:119 - Dados carregados - Treino: 1000, Teste: 1000
2025-08-05 11:42:39 | INFO     | src.utils:__exit__:322 - Carregamento de dados executado em 0.15s
2025-08-05 11:42:39 | INFO     | src.data:engineer_features:210 - Features processadas: 448 colunas
2025-08-05 11:42:39 | INFO     | src.utils:__exit__:322 - Engenharia de features executado em 0.20s
2025-08-05 11:42:40 | INFO     | src.data:engineer_features:210 - Features processadas: 447 colunas
2025-08-05 11:42:40 | INFO     | src.utils:__exit__:322 - Engenharia de features executado em 0.19s
2025-08-05 11:42:40 | INFO     | src.data:build_heterogeneous_graph:424 - Grafo criado com 1504 nós
2025-08-05 11:42:40 | INFO     | src.data:build_heterogeneous_graph:425 - Tipos de nós: ['transaction', 'user', 'card', 'device']
2025-08-05 11:42:40 | INFO     | src.data:build_heterogeneous_graph:426 - Tipos de arestas: [('user', 'makes', 'transaction'), ('transaction', 'uses', 'card'), ('transaction', 'from', 'device')]
2025-08-05 11:42:40 | INFO     | src.utils:__exit__:322 - Construção do grafo executado em 0.10s
2025-08-05 11:42:40 | INFO     | src.data:build_heterogeneous_graph:424 - Grafo criado com 1520 nós
2025-08-05 11:42:40 | INFO     | src.data:build_heterogeneous_graph:425 - Tipos de nós: ['transaction', 'user', 'card', 'device']
2025-08-05 11:42:40 | INFO     | src.data:build_heterogeneous_graph:426 - Tipos de arestas: [('user', 'makes', 'transaction'), ('transaction', 'uses', 'card'), ('transaction', 'from', 'device')]
2025-08-05 11:42:40 | INFO     | src.utils:__exit__:322 - Construção do grafo executado em 0.09s
2025-08-05 11:42:40 | INFO     | src.utils:__exit__:322 - Pipeline completo de dados executado em 0.73s
2025-08-05 11:42:40 | INFO     | main:load_and_process_data:64 - Dados processados: {'loader_info': {'transaction_train_shape': (1000, 394), 'transaction_test_shape': (1000, 393), 'identity_train_shape': (1000, 41), 'identity_test_shape': (1000, 41), 'fraud_rate': 0.015, 'missing_values': 159304}, 'train_graph': {'node_types': ['transaction', 'user', 'card', 'device'], 'edge_types': [('user', 'makes', 'transaction'), ('transaction', 'uses', 'card'), ('transaction', 'from', 'device')], 'num_transaction_nodes': 1000, 'num_features': 443, 'fraud_rate': 0.014999999664723873}}
2025-08-05 11:42:40 | INFO     | main:run_full_pipeline:152 - Etapa 2: Criação do modelo
2025-08-05 11:42:40 | INFO     | src.models:_build_model:132 - GraphSAGE construído: 3 camadas, dim oculta: 256, agregação: mean
2025-08-05 11:42:40 | INFO     | main:create_model:96 - Modelo criado: GraphSAGEModel
2025-08-05 11:42:40 | INFO     | main:create_model:97 - Parâmetros: 524,418
2025-08-05 11:42:40 | INFO     | src.utils:__exit__:322 - Criação do modelo executado em 0.03s
2025-08-05 11:42:40 | INFO     | main:run_full_pipeline:157 - Etapa 3: Treinamento do modelo
2025-08-05 11:42:40 | INFO     | src.utils:__exit__:322 - Treinamento do modelo executado em 0.00s
2025-08-05 11:42:40 | ERROR    | main:run_full_pipeline:169 - Erro no pipeline: '<=' not supported between instances of 'float' and 'str'
2025-08-05 11:45:35 | INFO     | src.utils:_load_config:41 - Configuração carregada de config.yaml
2025-08-05 11:45:35 | INFO     | main:__init__:41 - Sistema de detecção de fraude inicializado
2025-08-05 11:45:35 | INFO     | main:__init__:42 - Dispositivo: cpu
2025-08-05 11:45:35 | INFO     | main:run_full_pipeline:141 - Iniciando pipeline completo de detecção de fraude
2025-08-05 11:45:35 | INFO     | main:run_full_pipeline:147 - Etapa 1: Carregamento e processamento de dados
2025-08-05 11:45:35 | INFO     | main:setup_data_pipeline:50 - Pipeline de dados configurado
2025-08-05 11:45:35 | INFO     | src.utils:__exit__:322 - Configuração do pipeline de dados executado em 0.00s
2025-08-05 11:45:35 | INFO     | src.data:load_data:88 - Carregando dados de transação...
2025-08-05 11:45:35 | INFO     | src.data:load_data:102 - Carregando dados de identidade...
2025-08-05 11:45:35 | INFO     | src.data:load_data:119 - Dados carregados - Treino: 1000, Teste: 1000
2025-08-05 11:45:35 | INFO     | src.utils:__exit__:322 - Carregamento de dados executado em 0.05s
2025-08-05 11:45:35 | INFO     | src.data:engineer_features:210 - Features processadas: 448 colunas
2025-08-05 11:45:35 | INFO     | src.utils:__exit__:322 - Engenharia de features executado em 0.21s
2025-08-05 11:45:35 | INFO     | src.data:engineer_features:210 - Features processadas: 447 colunas
2025-08-05 11:45:35 | INFO     | src.utils:__exit__:322 - Engenharia de features executado em 0.19s
2025-08-05 11:45:35 | INFO     | src.data:build_heterogeneous_graph:424 - Grafo criado com 1504 nós
2025-08-05 11:45:35 | INFO     | src.data:build_heterogeneous_graph:425 - Tipos de nós: ['transaction', 'user', 'card', 'device']
2025-08-05 11:45:35 | INFO     | src.data:build_heterogeneous_graph:426 - Tipos de arestas: [('user', 'makes', 'transaction'), ('transaction', 'uses', 'card'), ('transaction', 'from', 'device')]
2025-08-05 11:45:35 | INFO     | src.utils:__exit__:322 - Construção do grafo executado em 0.11s
2025-08-05 11:45:35 | INFO     | src.data:build_heterogeneous_graph:424 - Grafo criado com 1520 nós
2025-08-05 11:45:35 | INFO     | src.data:build_heterogeneous_graph:425 - Tipos de nós: ['transaction', 'user', 'card', 'device']
2025-08-05 11:45:35 | INFO     | src.data:build_heterogeneous_graph:426 - Tipos de arestas: [('user', 'makes', 'transaction'), ('transaction', 'uses', 'card'), ('transaction', 'from', 'device')]
2025-08-05 11:45:35 | INFO     | src.utils:__exit__:322 - Construção do grafo executado em 0.09s
2025-08-05 11:45:35 | INFO     | src.utils:__exit__:322 - Pipeline completo de dados executado em 0.65s
2025-08-05 11:45:35 | INFO     | main:load_and_process_data:64 - Dados processados: {'loader_info': {'transaction_train_shape': (1000, 394), 'transaction_test_shape': (1000, 393), 'identity_train_shape': (1000, 41), 'identity_test_shape': (1000, 41), 'fraud_rate': 0.015, 'missing_values': 159304}, 'train_graph': {'node_types': ['transaction', 'user', 'card', 'device'], 'edge_types': [('user', 'makes', 'transaction'), ('transaction', 'uses', 'card'), ('transaction', 'from', 'device')], 'num_transaction_nodes': 1000, 'num_features': 443, 'fraud_rate': 0.014999999664723873}}
2025-08-05 11:45:35 | INFO     | main:run_full_pipeline:152 - Etapa 2: Criação do modelo
2025-08-05 11:45:35 | INFO     | src.models:_build_model:132 - GraphSAGE construído: 3 camadas, dim oculta: 256, agregação: mean
2025-08-05 11:45:35 | INFO     | main:create_model:96 - Modelo criado: GraphSAGEModel
2025-08-05 11:45:35 | INFO     | main:create_model:97 - Parâmetros: 524,418
2025-08-05 11:45:35 | INFO     | src.utils:__exit__:322 - Criação do modelo executado em 0.02s
2025-08-05 11:45:35 | INFO     | main:run_full_pipeline:157 - Etapa 3: Treinamento do modelo
2025-08-05 11:45:35 | INFO     | src.utils:__exit__:322 - Treinamento do modelo executado em 0.00s
2025-08-05 11:45:35 | ERROR    | main:run_full_pipeline:169 - Erro no pipeline: '<=' not supported between instances of 'float' and 'str'
2025-08-05 11:47:11 | INFO     | src.utils:_load_config:41 - Configuração carregada de config.yaml
2025-08-05 11:47:11 | INFO     | main:__init__:41 - Sistema de detecção de fraude inicializado
2025-08-05 11:47:11 | INFO     | main:__init__:42 - Dispositivo: cpu
2025-08-05 11:47:11 | INFO     | main:run_full_pipeline:141 - Iniciando pipeline completo de detecção de fraude
2025-08-05 11:47:11 | INFO     | main:run_full_pipeline:147 - Etapa 1: Carregamento e processamento de dados
2025-08-05 11:47:11 | INFO     | main:setup_data_pipeline:50 - Pipeline de dados configurado
2025-08-05 11:47:11 | INFO     | src.utils:__exit__:322 - Configuração do pipeline de dados executado em 0.00s
2025-08-05 11:47:11 | INFO     | src.data:load_data:88 - Carregando dados de transação...
2025-08-05 11:47:11 | INFO     | src.data:load_data:102 - Carregando dados de identidade...
2025-08-05 11:47:11 | INFO     | src.data:load_data:119 - Dados carregados - Treino: 1000, Teste: 1000
2025-08-05 11:47:11 | INFO     | src.utils:__exit__:322 - Carregamento de dados executado em 0.06s
2025-08-05 11:47:11 | INFO     | src.data:engineer_features:210 - Features processadas: 448 colunas
2025-08-05 11:47:11 | INFO     | src.utils:__exit__:322 - Engenharia de features executado em 0.20s
2025-08-05 11:47:11 | INFO     | src.data:engineer_features:210 - Features processadas: 447 colunas
2025-08-05 11:47:11 | INFO     | src.utils:__exit__:322 - Engenharia de features executado em 0.19s
2025-08-05 11:47:11 | INFO     | src.data:build_heterogeneous_graph:424 - Grafo criado com 1504 nós
2025-08-05 11:47:11 | INFO     | src.data:build_heterogeneous_graph:425 - Tipos de nós: ['transaction', 'user', 'card', 'device']
2025-08-05 11:47:11 | INFO     | src.data:build_heterogeneous_graph:426 - Tipos de arestas: [('user', 'makes', 'transaction'), ('transaction', 'uses', 'card'), ('transaction', 'from', 'device')]
2025-08-05 11:47:11 | INFO     | src.utils:__exit__:322 - Construção do grafo executado em 0.11s
2025-08-05 11:47:11 | INFO     | src.data:build_heterogeneous_graph:424 - Grafo criado com 1520 nós
2025-08-05 11:47:11 | INFO     | src.data:build_heterogeneous_graph:425 - Tipos de nós: ['transaction', 'user', 'card', 'device']
2025-08-05 11:47:11 | INFO     | src.data:build_heterogeneous_graph:426 - Tipos de arestas: [('user', 'makes', 'transaction'), ('transaction', 'uses', 'card'), ('transaction', 'from', 'device')]
2025-08-05 11:47:11 | INFO     | src.utils:__exit__:322 - Construção do grafo executado em 0.10s
2025-08-05 11:47:11 | INFO     | src.utils:__exit__:322 - Pipeline completo de dados executado em 0.65s
2025-08-05 11:47:11 | INFO     | main:load_and_process_data:64 - Dados processados: {'loader_info': {'transaction_train_shape': (1000, 394), 'transaction_test_shape': (1000, 393), 'identity_train_shape': (1000, 41), 'identity_test_shape': (1000, 41), 'fraud_rate': 0.015, 'missing_values': 159304}, 'train_graph': {'node_types': ['transaction', 'user', 'card', 'device'], 'edge_types': [('user', 'makes', 'transaction'), ('transaction', 'uses', 'card'), ('transaction', 'from', 'device')], 'num_transaction_nodes': 1000, 'num_features': 443, 'fraud_rate': 0.014999999664723873}}
2025-08-05 11:47:11 | INFO     | main:run_full_pipeline:152 - Etapa 2: Criação do modelo
2025-08-05 11:47:11 | INFO     | src.models:_build_model:132 - GraphSAGE construído: 3 camadas, dim oculta: 256, agregação: mean
2025-08-05 11:47:11 | INFO     | main:create_model:96 - Modelo criado: GraphSAGEModel
2025-08-05 11:47:11 | INFO     | main:create_model:97 - Parâmetros: 524,418
2025-08-05 11:47:11 | INFO     | src.utils:__exit__:322 - Criação do modelo executado em 0.02s
2025-08-05 11:47:11 | INFO     | main:run_full_pipeline:157 - Etapa 3: Treinamento do modelo
2025-08-05 11:47:11 | INFO     | src.utils:__exit__:322 - Treinamento do modelo executado em 0.00s
2025-08-05 11:47:11 | ERROR    | main:run_full_pipeline:169 - Erro no pipeline: '<=' not supported between instances of 'float' and 'str'
2025-08-05 11:47:11 | ERROR    | main:run_full_pipeline:171 - Traceback completo: Traceback (most recent call last):
  File "/home/pedro/Documentos/portfolio/FraudDetection/main.py", line 158, in run_full_pipeline
    training_history = self.train_model()
  File "/home/pedro/Documentos/portfolio/FraudDetection/main.py", line 108, in train_model
    self.trainer = GNNTrainer(
  File "/home/pedro/Documentos/portfolio/FraudDetection/src/training/__init__.py", line 249, in __init__
    self.optimizer = self._setup_optimizer()
  File "/home/pedro/Documentos/portfolio/FraudDetection/src/training/__init__.py", line 289, in _setup_optimizer
    return optim.Adam(
  File "/home/pedro/Documentos/portfolio/FraudDetection/.venv/lib/python3.10/site-packages/torch/optim/adam.py", line 65, in __init__
    if not 0.0 <= weight_decay:
TypeError: '<=' not supported between instances of 'float' and 'str'

2025-08-05 11:48:42 | INFO     | src.utils:_load_config:41 - Configuração carregada de config.yaml
2025-08-05 11:48:42 | INFO     | main:__init__:41 - Sistema de detecção de fraude inicializado
2025-08-05 11:48:42 | INFO     | main:__init__:42 - Dispositivo: cpu
2025-08-05 11:48:42 | INFO     | main:run_full_pipeline:141 - Iniciando pipeline completo de detecção de fraude
2025-08-05 11:48:42 | INFO     | main:run_full_pipeline:147 - Etapa 1: Carregamento e processamento de dados
2025-08-05 11:48:42 | INFO     | main:setup_data_pipeline:50 - Pipeline de dados configurado
2025-08-05 11:48:42 | INFO     | src.utils:__exit__:322 - Configuração do pipeline de dados executado em 0.00s
2025-08-05 11:48:42 | INFO     | src.data:load_data:88 - Carregando dados de transação...
2025-08-05 11:48:42 | INFO     | src.data:load_data:102 - Carregando dados de identidade...
2025-08-05 11:48:42 | INFO     | src.data:load_data:119 - Dados carregados - Treino: 1000, Teste: 1000
2025-08-05 11:48:42 | INFO     | src.utils:__exit__:322 - Carregamento de dados executado em 0.05s
2025-08-05 11:48:42 | INFO     | src.data:engineer_features:210 - Features processadas: 448 colunas
2025-08-05 11:48:42 | INFO     | src.utils:__exit__:322 - Engenharia de features executado em 0.20s
2025-08-05 11:48:43 | INFO     | src.data:engineer_features:210 - Features processadas: 447 colunas
2025-08-05 11:48:43 | INFO     | src.utils:__exit__:322 - Engenharia de features executado em 0.19s
2025-08-05 11:48:43 | INFO     | src.data:build_heterogeneous_graph:424 - Grafo criado com 1504 nós
2025-08-05 11:48:43 | INFO     | src.data:build_heterogeneous_graph:425 - Tipos de nós: ['transaction', 'user', 'card', 'device']
2025-08-05 11:48:43 | INFO     | src.data:build_heterogeneous_graph:426 - Tipos de arestas: [('user', 'makes', 'transaction'), ('transaction', 'uses', 'card'), ('transaction', 'from', 'device')]
2025-08-05 11:48:43 | INFO     | src.utils:__exit__:322 - Construção do grafo executado em 0.11s
2025-08-05 11:48:43 | INFO     | src.data:build_heterogeneous_graph:424 - Grafo criado com 1520 nós
2025-08-05 11:48:43 | INFO     | src.data:build_heterogeneous_graph:425 - Tipos de nós: ['transaction', 'user', 'card', 'device']
2025-08-05 11:48:43 | INFO     | src.data:build_heterogeneous_graph:426 - Tipos de arestas: [('user', 'makes', 'transaction'), ('transaction', 'uses', 'card'), ('transaction', 'from', 'device')]
2025-08-05 11:48:43 | INFO     | src.utils:__exit__:322 - Construção do grafo executado em 0.10s
2025-08-05 11:48:43 | INFO     | src.utils:__exit__:322 - Pipeline completo de dados executado em 0.65s
2025-08-05 11:48:43 | INFO     | main:load_and_process_data:64 - Dados processados: {'loader_info': {'transaction_train_shape': (1000, 394), 'transaction_test_shape': (1000, 393), 'identity_train_shape': (1000, 41), 'identity_test_shape': (1000, 41), 'fraud_rate': 0.015, 'missing_values': 159304}, 'train_graph': {'node_types': ['transaction', 'user', 'card', 'device'], 'edge_types': [('user', 'makes', 'transaction'), ('transaction', 'uses', 'card'), ('transaction', 'from', 'device')], 'num_transaction_nodes': 1000, 'num_features': 443, 'fraud_rate': 0.014999999664723873}}
2025-08-05 11:48:43 | INFO     | main:run_full_pipeline:152 - Etapa 2: Criação do modelo
2025-08-05 11:48:43 | INFO     | src.models:_build_model:132 - GraphSAGE construído: 3 camadas, dim oculta: 256, agregação: mean
2025-08-05 11:48:43 | INFO     | main:create_model:96 - Modelo criado: GraphSAGEModel
2025-08-05 11:48:43 | INFO     | main:create_model:97 - Parâmetros: 524,418
2025-08-05 11:48:43 | INFO     | src.utils:__exit__:322 - Criação do modelo executado em 0.02s
2025-08-05 11:48:43 | INFO     | main:run_full_pipeline:157 - Etapa 3: Treinamento do modelo
2025-08-05 11:48:43 | INFO     | src.training:__init__:276 - Trainer inicializado - Dispositivo: cpu
2025-08-05 11:48:43 | INFO     | src.training:__init__:277 - Modelo: GraphSAGEModel
2025-08-05 11:48:43 | INFO     | src.training:__init__:278 - Parâmetros treináveis: 524,418
2025-08-05 11:48:43 | INFO     | src.training:train:475 - Iniciando treinamento para 5 épocas
2025-08-05 11:48:43 | INFO     | src.utils:__exit__:322 - Treinamento completo (5 épocas) executado em 0.00s
2025-08-05 11:48:43 | INFO     | src.utils:__exit__:322 - Treinamento do modelo executado em 0.00s
2025-08-05 11:48:43 | ERROR    | main:run_full_pipeline:169 - Erro no pipeline: `MessagePassing.propagate` only supports integer tensors of shape `[2, num_messages]`, `torch_sparse.SparseTensor` or `torch.sparse.Tensor` for argument `edge_index`.
2025-08-05 11:48:43 | ERROR    | main:run_full_pipeline:171 - Traceback completo: Traceback (most recent call last):
  File "/home/pedro/Documentos/portfolio/FraudDetection/main.py", line 158, in run_full_pipeline
    training_history = self.train_model()
  File "/home/pedro/Documentos/portfolio/FraudDetection/main.py", line 116, in train_model
    history = self.trainer.train(epochs=epochs, verbose=True)
  File "/home/pedro/Documentos/portfolio/FraudDetection/src/training/__init__.py", line 483, in train
    train_loss, train_metrics = self.train_epoch()
  File "/home/pedro/Documentos/portfolio/FraudDetection/src/training/__init__.py", line 363, in train_epoch
    logits = self.model(self.data.x_dict, self.data.edge_index_dict)
  File "/home/pedro/Documentos/portfolio/FraudDetection/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/pedro/Documentos/portfolio/FraudDetection/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/pedro/Documentos/portfolio/FraudDetection/src/models/__init__.py", line 150, in forward
    x = conv(x, edge_index)
  File "/home/pedro/Documentos/portfolio/FraudDetection/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/pedro/Documentos/portfolio/FraudDetection/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/pedro/Documentos/portfolio/FraudDetection/.venv/lib/python3.10/site-packages/torch_geometric/nn/conv/sage_conv.py", line 134, in forward
    out = self.propagate(edge_index, x=x, size=size)
  File "/tmp/torch_geometric.nn.conv.sage_conv_SAGEConv_propagate_l5r6q4ji.py", line 128, in propagate
    mutable_size = self._check_input(edge_index, size)
  File "/home/pedro/Documentos/portfolio/FraudDetection/.venv/lib/python3.10/site-packages/torch_geometric/nn/conv/message_passing.py", line 244, in _check_input
    raise ValueError(
ValueError: `MessagePassing.propagate` only supports integer tensors of shape `[2, num_messages]`, `torch_sparse.SparseTensor` or `torch.sparse.Tensor` for argument `edge_index`.

2025-08-05 11:54:47 | INFO     | src.utils:_load_config:41 - Configuração carregada de config.yaml
2025-08-05 11:54:47 | INFO     | main:__init__:41 - Sistema de detecção de fraude inicializado
2025-08-05 11:54:47 | INFO     | main:__init__:42 - Dispositivo: cpu
2025-08-05 11:54:47 | INFO     | main:run_full_pipeline:145 - Iniciando pipeline completo de detecção de fraude
2025-08-05 11:54:47 | INFO     | main:run_full_pipeline:151 - Etapa 1: Carregamento e processamento de dados
2025-08-05 11:54:47 | INFO     | main:setup_data_pipeline:50 - Pipeline de dados configurado
2025-08-05 11:54:47 | INFO     | src.utils:__exit__:322 - Configuração do pipeline de dados executado em 0.00s
2025-08-05 11:54:47 | INFO     | src.data:load_data:88 - Carregando dados de transação...
2025-08-05 11:54:47 | INFO     | src.data:load_data:102 - Carregando dados de identidade...
2025-08-05 11:54:47 | INFO     | src.data:load_data:119 - Dados carregados - Treino: 1000, Teste: 1000
2025-08-05 11:54:47 | INFO     | src.utils:__exit__:322 - Carregamento de dados executado em 0.05s
2025-08-05 11:54:47 | INFO     | src.data:engineer_features:210 - Features processadas: 448 colunas
2025-08-05 11:54:47 | INFO     | src.utils:__exit__:322 - Engenharia de features executado em 0.20s
2025-08-05 11:54:47 | INFO     | src.data:engineer_features:210 - Features processadas: 447 colunas
2025-08-05 11:54:47 | INFO     | src.utils:__exit__:322 - Engenharia de features executado em 0.19s
2025-08-05 11:54:47 | INFO     | src.data:build_heterogeneous_graph:424 - Grafo criado com 1504 nós
2025-08-05 11:54:47 | INFO     | src.data:build_heterogeneous_graph:425 - Tipos de nós: ['transaction', 'user', 'card', 'device']
2025-08-05 11:54:47 | INFO     | src.data:build_heterogeneous_graph:426 - Tipos de arestas: [('user', 'makes', 'transaction'), ('transaction', 'uses', 'card'), ('transaction', 'from', 'device')]
2025-08-05 11:54:47 | INFO     | src.utils:__exit__:322 - Construção do grafo executado em 0.10s
2025-08-05 11:54:47 | INFO     | src.data:build_heterogeneous_graph:424 - Grafo criado com 1520 nós
2025-08-05 11:54:47 | INFO     | src.data:build_heterogeneous_graph:425 - Tipos de nós: ['transaction', 'user', 'card', 'device']
2025-08-05 11:54:47 | INFO     | src.data:build_heterogeneous_graph:426 - Tipos de arestas: [('user', 'makes', 'transaction'), ('transaction', 'uses', 'card'), ('transaction', 'from', 'device')]
2025-08-05 11:54:47 | INFO     | src.utils:__exit__:322 - Construção do grafo executado em 0.10s
2025-08-05 11:54:47 | INFO     | src.utils:__exit__:322 - Pipeline completo de dados executado em 0.64s
2025-08-05 11:54:47 | INFO     | main:load_and_process_data:64 - Dados processados: {'loader_info': {'transaction_train_shape': (1000, 394), 'transaction_test_shape': (1000, 393), 'identity_train_shape': (1000, 41), 'identity_test_shape': (1000, 41), 'fraud_rate': 0.015, 'missing_values': 159304}, 'train_graph': {'node_types': ['transaction', 'user', 'card', 'device'], 'edge_types': [('user', 'makes', 'transaction'), ('transaction', 'uses', 'card'), ('transaction', 'from', 'device')], 'num_transaction_nodes': 1000, 'num_features': 443, 'fraud_rate': 0.014999999664723873}}
2025-08-05 11:54:47 | INFO     | main:run_full_pipeline:156 - Etapa 2: Criação do modelo
2025-08-05 11:54:47 | INFO     | main:create_model:77 - Detectado grafo heterogêneo, usando modelo HeteroGNN
2025-08-05 11:54:47 | INFO     | src.utils:__exit__:322 - Criação do modelo executado em 0.00s
2025-08-05 11:54:47 | ERROR    | main:run_full_pipeline:173 - Erro no pipeline: HeteroGNNModel.__init__() got an unexpected keyword argument 'type'
2025-08-05 11:54:47 | ERROR    | main:run_full_pipeline:175 - Traceback completo: Traceback (most recent call last):
  File "/home/pedro/Documentos/portfolio/FraudDetection/main.py", line 157, in run_full_pipeline
    self.create_model()
  File "/home/pedro/Documentos/portfolio/FraudDetection/main.py", line 98, in create_model
    self.model = ModelFactory.create_model(**model_params)
  File "/home/pedro/Documentos/portfolio/FraudDetection/src/models/__init__.py", line 470, in create_model
    return HeteroGNNModel(
TypeError: HeteroGNNModel.__init__() got an unexpected keyword argument 'type'

2025-08-05 11:56:21 | INFO     | src.utils:_load_config:41 - Configuração carregada de config.yaml
2025-08-05 11:56:21 | INFO     | main:__init__:41 - Sistema de detecção de fraude inicializado
2025-08-05 11:56:21 | INFO     | main:__init__:42 - Dispositivo: cpu
2025-08-05 11:56:21 | INFO     | main:run_full_pipeline:157 - Iniciando pipeline completo de detecção de fraude
2025-08-05 11:56:21 | INFO     | main:run_full_pipeline:163 - Etapa 1: Carregamento e processamento de dados
2025-08-05 11:56:21 | INFO     | main:setup_data_pipeline:50 - Pipeline de dados configurado
2025-08-05 11:56:21 | INFO     | src.utils:__exit__:322 - Configuração do pipeline de dados executado em 0.00s
2025-08-05 11:56:21 | INFO     | src.data:load_data:88 - Carregando dados de transação...
2025-08-05 11:56:21 | INFO     | src.data:load_data:102 - Carregando dados de identidade...
2025-08-05 11:56:21 | INFO     | src.data:load_data:119 - Dados carregados - Treino: 1000, Teste: 1000
2025-08-05 11:56:21 | INFO     | src.utils:__exit__:322 - Carregamento de dados executado em 0.05s
2025-08-05 11:56:21 | INFO     | src.data:engineer_features:210 - Features processadas: 448 colunas
2025-08-05 11:56:21 | INFO     | src.utils:__exit__:322 - Engenharia de features executado em 0.20s
2025-08-05 11:56:21 | INFO     | src.data:engineer_features:210 - Features processadas: 447 colunas
2025-08-05 11:56:21 | INFO     | src.utils:__exit__:322 - Engenharia de features executado em 0.19s
2025-08-05 11:56:22 | INFO     | src.data:build_heterogeneous_graph:424 - Grafo criado com 1504 nós
2025-08-05 11:56:22 | INFO     | src.data:build_heterogeneous_graph:425 - Tipos de nós: ['transaction', 'user', 'card', 'device']
2025-08-05 11:56:22 | INFO     | src.data:build_heterogeneous_graph:426 - Tipos de arestas: [('user', 'makes', 'transaction'), ('transaction', 'uses', 'card'), ('transaction', 'from', 'device')]
2025-08-05 11:56:22 | INFO     | src.utils:__exit__:322 - Construção do grafo executado em 0.10s
2025-08-05 11:56:22 | INFO     | src.data:build_heterogeneous_graph:424 - Grafo criado com 1520 nós
2025-08-05 11:56:22 | INFO     | src.data:build_heterogeneous_graph:425 - Tipos de nós: ['transaction', 'user', 'card', 'device']
2025-08-05 11:56:22 | INFO     | src.data:build_heterogeneous_graph:426 - Tipos de arestas: [('user', 'makes', 'transaction'), ('transaction', 'uses', 'card'), ('transaction', 'from', 'device')]
2025-08-05 11:56:22 | INFO     | src.utils:__exit__:322 - Construção do grafo executado em 0.10s
2025-08-05 11:56:22 | INFO     | src.utils:__exit__:322 - Pipeline completo de dados executado em 0.64s
2025-08-05 11:56:22 | INFO     | main:load_and_process_data:64 - Dados processados: {'loader_info': {'transaction_train_shape': (1000, 394), 'transaction_test_shape': (1000, 393), 'identity_train_shape': (1000, 41), 'identity_test_shape': (1000, 41), 'fraud_rate': 0.015, 'missing_values': 159304}, 'train_graph': {'node_types': ['transaction', 'user', 'card', 'device'], 'edge_types': [('user', 'makes', 'transaction'), ('transaction', 'uses', 'card'), ('transaction', 'from', 'device')], 'num_transaction_nodes': 1000, 'num_features': 443, 'fraud_rate': 0.014999999664723873}}
2025-08-05 11:56:22 | INFO     | main:run_full_pipeline:168 - Etapa 2: Criação do modelo
2025-08-05 11:56:22 | INFO     | main:create_model:77 - Detectado grafo heterogêneo, usando modelo HeteroGNN
2025-08-05 11:56:22 | INFO     | src.utils:__exit__:322 - Criação do modelo executado em 0.00s
2025-08-05 11:56:22 | ERROR    | main:run_full_pipeline:185 - Erro no pipeline: ModelFactory.create_model() missing 1 required positional argument: 'input_dim'
2025-08-05 11:56:22 | ERROR    | main:run_full_pipeline:187 - Traceback completo: Traceback (most recent call last):
  File "/home/pedro/Documentos/portfolio/FraudDetection/main.py", line 169, in run_full_pipeline
    self.create_model()
  File "/home/pedro/Documentos/portfolio/FraudDetection/main.py", line 110, in create_model
    self.model = ModelFactory.create_model(**model_params)
TypeError: ModelFactory.create_model() missing 1 required positional argument: 'input_dim'

2025-08-05 11:57:05 | INFO     | src.utils:_load_config:41 - Configuração carregada de config.yaml
2025-08-05 11:57:05 | INFO     | main:__init__:41 - Sistema de detecção de fraude inicializado
2025-08-05 11:57:05 | INFO     | main:__init__:42 - Dispositivo: cpu
2025-08-05 11:57:05 | INFO     | main:run_full_pipeline:159 - Iniciando pipeline completo de detecção de fraude
2025-08-05 11:57:05 | INFO     | main:run_full_pipeline:165 - Etapa 1: Carregamento e processamento de dados
2025-08-05 11:57:05 | INFO     | main:setup_data_pipeline:50 - Pipeline de dados configurado
2025-08-05 11:57:05 | INFO     | src.utils:__exit__:322 - Configuração do pipeline de dados executado em 0.00s
2025-08-05 11:57:05 | INFO     | src.data:load_data:88 - Carregando dados de transação...
2025-08-05 11:57:05 | INFO     | src.data:load_data:102 - Carregando dados de identidade...
2025-08-05 11:57:06 | INFO     | src.data:load_data:119 - Dados carregados - Treino: 1000, Teste: 1000
2025-08-05 11:57:06 | INFO     | src.utils:__exit__:322 - Carregamento de dados executado em 0.05s
2025-08-05 11:57:06 | INFO     | src.data:engineer_features:210 - Features processadas: 448 colunas
2025-08-05 11:57:06 | INFO     | src.utils:__exit__:322 - Engenharia de features executado em 0.20s
2025-08-05 11:57:06 | INFO     | src.data:engineer_features:210 - Features processadas: 447 colunas
2025-08-05 11:57:06 | INFO     | src.utils:__exit__:322 - Engenharia de features executado em 0.20s
2025-08-05 11:57:06 | INFO     | src.data:build_heterogeneous_graph:424 - Grafo criado com 1504 nós
2025-08-05 11:57:06 | INFO     | src.data:build_heterogeneous_graph:425 - Tipos de nós: ['transaction', 'user', 'card', 'device']
2025-08-05 11:57:06 | INFO     | src.data:build_heterogeneous_graph:426 - Tipos de arestas: [('user', 'makes', 'transaction'), ('transaction', 'uses', 'card'), ('transaction', 'from', 'device')]
2025-08-05 11:57:06 | INFO     | src.utils:__exit__:322 - Construção do grafo executado em 0.10s
2025-08-05 11:57:06 | INFO     | src.data:build_heterogeneous_graph:424 - Grafo criado com 1520 nós
2025-08-05 11:57:06 | INFO     | src.data:build_heterogeneous_graph:425 - Tipos de nós: ['transaction', 'user', 'card', 'device']
2025-08-05 11:57:06 | INFO     | src.data:build_heterogeneous_graph:426 - Tipos de arestas: [('user', 'makes', 'transaction'), ('transaction', 'uses', 'card'), ('transaction', 'from', 'device')]
2025-08-05 11:57:06 | INFO     | src.utils:__exit__:322 - Construção do grafo executado em 0.10s
2025-08-05 11:57:06 | INFO     | src.utils:__exit__:322 - Pipeline completo de dados executado em 0.65s
2025-08-05 11:57:06 | INFO     | main:load_and_process_data:64 - Dados processados: {'loader_info': {'transaction_train_shape': (1000, 394), 'transaction_test_shape': (1000, 393), 'identity_train_shape': (1000, 41), 'identity_test_shape': (1000, 41), 'fraud_rate': 0.015, 'missing_values': 159304}, 'train_graph': {'node_types': ['transaction', 'user', 'card', 'device'], 'edge_types': [('user', 'makes', 'transaction'), ('transaction', 'uses', 'card'), ('transaction', 'from', 'device')], 'num_transaction_nodes': 1000, 'num_features': 443, 'fraud_rate': 0.014999999664723873}}
2025-08-05 11:57:06 | INFO     | main:run_full_pipeline:170 - Etapa 2: Criação do modelo
2025-08-05 11:57:06 | INFO     | main:create_model:77 - Detectado grafo heterogêneo, usando modelo HeteroGNN
2025-08-05 11:57:06 | INFO     | src.models:__init__:325 - HeteroGNN construído: MEAN, 3 camadas, dim: 256
2025-08-05 11:57:06 | INFO     | main:create_model:114 - Modelo criado: HeteroGNNModel
2025-08-05 11:57:06 | INFO     | main:create_model:115 - Parâmetros: 33,154
2025-08-05 11:57:06 | INFO     | src.utils:__exit__:322 - Criação do modelo executado em 0.00s
2025-08-05 11:57:06 | INFO     | main:run_full_pipeline:175 - Etapa 3: Treinamento do modelo
2025-08-05 11:57:06 | INFO     | src.training:__init__:276 - Trainer inicializado - Dispositivo: cpu
2025-08-05 11:57:06 | INFO     | src.training:__init__:277 - Modelo: HeteroGNNModel
2025-08-05 11:57:06 | INFO     | src.training:__init__:278 - Parâmetros treináveis: 33,154
2025-08-05 11:57:06 | INFO     | src.training:train:475 - Iniciando treinamento para 5 épocas
2025-08-05 11:57:06 | INFO     | src.utils:__exit__:322 - Treinamento completo (5 épocas) executado em 0.00s
2025-08-05 11:57:06 | INFO     | src.utils:__exit__:322 - Treinamento do modelo executado em 0.00s
2025-08-05 11:57:06 | ERROR    | main:run_full_pipeline:187 - Erro no pipeline: 'transaction'
2025-08-05 11:57:06 | ERROR    | main:run_full_pipeline:189 - Traceback completo: Traceback (most recent call last):
  File "/home/pedro/Documentos/portfolio/FraudDetection/main.py", line 176, in run_full_pipeline
    training_history = self.train_model()
  File "/home/pedro/Documentos/portfolio/FraudDetection/main.py", line 134, in train_model
    history = self.trainer.train(epochs=epochs, verbose=True)
  File "/home/pedro/Documentos/portfolio/FraudDetection/src/training/__init__.py", line 483, in train
    train_loss, train_metrics = self.train_epoch()
  File "/home/pedro/Documentos/portfolio/FraudDetection/src/training/__init__.py", line 363, in train_epoch
    logits = self.model(self.data.x_dict, self.data.edge_index_dict)
  File "/home/pedro/Documentos/portfolio/FraudDetection/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/pedro/Documentos/portfolio/FraudDetection/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/pedro/Documentos/portfolio/FraudDetection/src/models/__init__.py", line 387, in forward
    transaction_embeddings = x_dict['transaction']
KeyError: 'transaction'

2025-08-05 12:01:23 | INFO     | src.utils:_load_config:41 - Configuração carregada de config.yaml
2025-08-05 12:01:23 | INFO     | main:__init__:41 - Sistema de detecção de fraude inicializado
2025-08-05 12:01:23 | INFO     | main:__init__:42 - Dispositivo: cpu
2025-08-05 12:01:23 | INFO     | main:run_full_pipeline:159 - Iniciando pipeline completo de detecção de fraude
2025-08-05 12:01:23 | INFO     | main:run_full_pipeline:165 - Etapa 1: Carregamento e processamento de dados
2025-08-05 12:01:23 | INFO     | main:setup_data_pipeline:50 - Pipeline de dados configurado
2025-08-05 12:01:23 | INFO     | src.utils:__exit__:322 - Configuração do pipeline de dados executado em 0.00s
2025-08-05 12:01:23 | INFO     | src.data:load_data:88 - Carregando dados de transação...
2025-08-05 12:01:23 | INFO     | src.data:load_data:102 - Carregando dados de identidade...
2025-08-05 12:01:23 | INFO     | src.data:load_data:119 - Dados carregados - Treino: 1000, Teste: 1000
2025-08-05 12:01:23 | INFO     | src.utils:__exit__:322 - Carregamento de dados executado em 0.06s
2025-08-05 12:01:24 | INFO     | src.data:engineer_features:210 - Features processadas: 448 colunas
2025-08-05 12:01:24 | INFO     | src.utils:__exit__:322 - Engenharia de features executado em 0.20s
2025-08-05 12:01:24 | INFO     | src.data:engineer_features:210 - Features processadas: 447 colunas
2025-08-05 12:01:24 | INFO     | src.utils:__exit__:322 - Engenharia de features executado em 0.19s
2025-08-05 12:01:24 | INFO     | src.data:build_heterogeneous_graph:424 - Grafo criado com 1504 nós
2025-08-05 12:01:24 | INFO     | src.data:build_heterogeneous_graph:425 - Tipos de nós: ['transaction', 'user', 'card', 'device']
2025-08-05 12:01:24 | INFO     | src.data:build_heterogeneous_graph:426 - Tipos de arestas: [('user', 'makes', 'transaction'), ('transaction', 'uses', 'card'), ('transaction', 'from', 'device')]
2025-08-05 12:01:24 | INFO     | src.utils:__exit__:322 - Construção do grafo executado em 0.10s
2025-08-05 12:01:24 | INFO     | src.data:build_heterogeneous_graph:424 - Grafo criado com 1520 nós
2025-08-05 12:01:24 | INFO     | src.data:build_heterogeneous_graph:425 - Tipos de nós: ['transaction', 'user', 'card', 'device']
2025-08-05 12:01:24 | INFO     | src.data:build_heterogeneous_graph:426 - Tipos de arestas: [('user', 'makes', 'transaction'), ('transaction', 'uses', 'card'), ('transaction', 'from', 'device')]
2025-08-05 12:01:24 | INFO     | src.utils:__exit__:322 - Construção do grafo executado em 0.10s
2025-08-05 12:01:24 | INFO     | src.utils:__exit__:322 - Pipeline completo de dados executado em 0.64s
2025-08-05 12:01:24 | INFO     | main:load_and_process_data:64 - Dados processados: {'loader_info': {'transaction_train_shape': (1000, 394), 'transaction_test_shape': (1000, 393), 'identity_train_shape': (1000, 41), 'identity_test_shape': (1000, 41), 'fraud_rate': 0.015, 'missing_values': 159304}, 'train_graph': {'node_types': ['transaction', 'user', 'card', 'device'], 'edge_types': [('user', 'makes', 'transaction'), ('transaction', 'uses', 'card'), ('transaction', 'from', 'device')], 'num_transaction_nodes': 1000, 'num_features': 443, 'fraud_rate': 0.014999999664723873}}
2025-08-05 12:01:24 | INFO     | main:run_full_pipeline:170 - Etapa 2: Criação do modelo
2025-08-05 12:01:24 | INFO     | main:create_model:77 - Detectado grafo heterogêneo, usando modelo HeteroGNN
2025-08-05 12:01:24 | INFO     | src.models:__init__:325 - HeteroGNN construído: MEAN, 3 camadas, dim: 256
2025-08-05 12:01:24 | INFO     | main:create_model:114 - Modelo criado: HeteroGNNModel
2025-08-05 12:01:24 | INFO     | main:create_model:115 - Parâmetros: 33,154
2025-08-05 12:01:24 | INFO     | src.utils:__exit__:322 - Criação do modelo executado em 0.00s
2025-08-05 12:01:24 | INFO     | main:run_full_pipeline:175 - Etapa 3: Treinamento do modelo
2025-08-05 12:01:24 | INFO     | src.training:__init__:276 - Trainer inicializado - Dispositivo: cpu
2025-08-05 12:01:24 | INFO     | src.training:__init__:277 - Modelo: HeteroGNNModel
2025-08-05 12:01:24 | INFO     | src.training:__init__:278 - Parâmetros treináveis: 33,154
2025-08-05 12:01:24 | INFO     | src.training:train:479 - Iniciando treinamento para 5 épocas
2025-08-05 12:01:24 | INFO     | src.utils:__exit__:322 - Treinamento completo (5 épocas) executado em 0.00s
2025-08-05 12:01:24 | INFO     | src.utils:__exit__:322 - Treinamento do modelo executado em 0.00s
2025-08-05 12:01:24 | ERROR    | main:run_full_pipeline:187 - Erro no pipeline: 'transaction'
2025-08-05 12:01:24 | ERROR    | main:run_full_pipeline:189 - Traceback completo: Traceback (most recent call last):
  File "/home/pedro/Documentos/portfolio/FraudDetection/main.py", line 176, in run_full_pipeline
    training_history = self.train_model()
  File "/home/pedro/Documentos/portfolio/FraudDetection/main.py", line 134, in train_model
    history = self.trainer.train(epochs=epochs, verbose=True)
  File "/home/pedro/Documentos/portfolio/FraudDetection/src/training/__init__.py", line 487, in train
    train_loss, train_metrics = self.train_epoch()
  File "/home/pedro/Documentos/portfolio/FraudDetection/src/training/__init__.py", line 365, in train_epoch
    logits = self.model(self.data.x_dict, self.data.edge_index_dict)
  File "/home/pedro/Documentos/portfolio/FraudDetection/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/pedro/Documentos/portfolio/FraudDetection/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/pedro/Documentos/portfolio/FraudDetection/src/models/__init__.py", line 387, in forward
    transaction_embeddings = x_dict['transaction']
KeyError: 'transaction'

2025-08-05 12:05:13 | INFO     | src.utils:_load_config:41 - Configuração carregada de config.yaml
2025-08-05 12:05:13 | INFO     | main:__init__:41 - Sistema de detecção de fraude inicializado
2025-08-05 12:05:13 | INFO     | main:__init__:42 - Dispositivo: cpu
2025-08-05 12:05:13 | INFO     | main:run_full_pipeline:159 - Iniciando pipeline completo de detecção de fraude
2025-08-05 12:05:13 | INFO     | main:run_full_pipeline:165 - Etapa 1: Carregamento e processamento de dados
2025-08-05 12:05:13 | INFO     | main:setup_data_pipeline:50 - Pipeline de dados configurado
2025-08-05 12:05:13 | INFO     | src.utils:__exit__:322 - Configuração do pipeline de dados executado em 0.00s
2025-08-05 12:05:13 | INFO     | src.data:load_data:88 - Carregando dados de transação...
2025-08-05 12:05:13 | INFO     | src.data:load_data:102 - Carregando dados de identidade...
2025-08-05 12:05:13 | INFO     | src.data:load_data:119 - Dados carregados - Treino: 1000, Teste: 1000
2025-08-05 12:05:13 | INFO     | src.utils:__exit__:322 - Carregamento de dados executado em 0.05s
2025-08-05 12:05:13 | INFO     | src.data:engineer_features:210 - Features processadas: 448 colunas
2025-08-05 12:05:13 | INFO     | src.utils:__exit__:322 - Engenharia de features executado em 0.20s
2025-08-05 12:05:13 | INFO     | src.data:engineer_features:210 - Features processadas: 447 colunas
2025-08-05 12:05:13 | INFO     | src.utils:__exit__:322 - Engenharia de features executado em 0.18s
2025-08-05 12:05:13 | INFO     | src.data:build_heterogeneous_graph:424 - Grafo criado com 1504 nós
2025-08-05 12:05:13 | INFO     | src.data:build_heterogeneous_graph:425 - Tipos de nós: ['transaction', 'user', 'card', 'device']
2025-08-05 12:05:13 | INFO     | src.data:build_heterogeneous_graph:426 - Tipos de arestas: [('user', 'makes', 'transaction'), ('transaction', 'uses', 'card'), ('transaction', 'from', 'device')]
2025-08-05 12:05:13 | INFO     | src.utils:__exit__:322 - Construção do grafo executado em 0.11s
2025-08-05 12:05:13 | INFO     | src.data:build_heterogeneous_graph:424 - Grafo criado com 1520 nós
2025-08-05 12:05:13 | INFO     | src.data:build_heterogeneous_graph:425 - Tipos de nós: ['transaction', 'user', 'card', 'device']
2025-08-05 12:05:13 | INFO     | src.data:build_heterogeneous_graph:426 - Tipos de arestas: [('user', 'makes', 'transaction'), ('transaction', 'uses', 'card'), ('transaction', 'from', 'device')]
2025-08-05 12:05:13 | INFO     | src.utils:__exit__:322 - Construção do grafo executado em 0.10s
2025-08-05 12:05:13 | INFO     | src.utils:__exit__:322 - Pipeline completo de dados executado em 0.65s
2025-08-05 12:05:13 | INFO     | main:load_and_process_data:64 - Dados processados: {'loader_info': {'transaction_train_shape': (1000, 394), 'transaction_test_shape': (1000, 393), 'identity_train_shape': (1000, 41), 'identity_test_shape': (1000, 41), 'fraud_rate': 0.015, 'missing_values': 159304}, 'train_graph': {'node_types': ['transaction', 'user', 'card', 'device'], 'edge_types': [('user', 'makes', 'transaction'), ('transaction', 'uses', 'card'), ('transaction', 'from', 'device')], 'num_transaction_nodes': 1000, 'num_features': 443, 'fraud_rate': 0.014999999664723873}}
2025-08-05 12:05:13 | INFO     | main:run_full_pipeline:170 - Etapa 2: Criação do modelo
2025-08-05 12:05:13 | INFO     | main:create_model:77 - Detectado grafo heterogêneo, usando modelo HeteroGNN
2025-08-05 12:05:13 | INFO     | src.models:__init__:325 - HeteroGNN construído: MEAN, 3 camadas, dim: 256
2025-08-05 12:05:13 | INFO     | main:create_model:114 - Modelo criado: HeteroGNNModel
2025-08-05 12:05:13 | INFO     | main:create_model:115 - Parâmetros: 33,154
2025-08-05 12:05:13 | INFO     | src.utils:__exit__:322 - Criação do modelo executado em 0.00s
2025-08-05 12:05:13 | INFO     | main:run_full_pipeline:175 - Etapa 3: Treinamento do modelo
2025-08-05 12:05:13 | INFO     | src.training:__init__:276 - Trainer inicializado - Dispositivo: cpu
2025-08-05 12:05:13 | INFO     | src.training:__init__:277 - Modelo: HeteroGNNModel
2025-08-05 12:05:13 | INFO     | src.training:__init__:278 - Parâmetros treináveis: 33,154
2025-08-05 12:05:13 | INFO     | src.training:train:479 - Iniciando treinamento para 5 épocas
2025-08-05 12:05:13 | INFO     | src.utils:__exit__:322 - Treinamento completo (5 épocas) executado em 0.00s
2025-08-05 12:05:13 | INFO     | src.utils:__exit__:322 - Treinamento do modelo executado em 0.00s
2025-08-05 12:05:13 | ERROR    | main:run_full_pipeline:187 - Erro no pipeline: "'transaction' not found in final x_dict. Available keys: []"
2025-08-05 12:05:13 | ERROR    | main:run_full_pipeline:189 - Traceback completo: Traceback (most recent call last):
  File "/home/pedro/Documentos/portfolio/FraudDetection/main.py", line 176, in run_full_pipeline
    training_history = self.train_model()
  File "/home/pedro/Documentos/portfolio/FraudDetection/main.py", line 134, in train_model
    history = self.trainer.train(epochs=epochs, verbose=True)
  File "/home/pedro/Documentos/portfolio/FraudDetection/src/training/__init__.py", line 487, in train
    train_loss, train_metrics = self.train_epoch()
  File "/home/pedro/Documentos/portfolio/FraudDetection/src/training/__init__.py", line 365, in train_epoch
    logits = self.model(self.data.x_dict, self.data.edge_index_dict)
  File "/home/pedro/Documentos/portfolio/FraudDetection/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/pedro/Documentos/portfolio/FraudDetection/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/pedro/Documentos/portfolio/FraudDetection/src/models/__init__.py", line 398, in forward
    raise KeyError(f"'transaction' not found in final x_dict. Available keys: {list(x_dict.keys())}")
KeyError: "'transaction' not found in final x_dict. Available keys: []"

2025-08-05 12:07:52 | INFO     | src.utils:_load_config:41 - Configuração carregada de config.yaml
2025-08-05 12:07:52 | INFO     | main:__init__:41 - Sistema de detecção de fraude inicializado
2025-08-05 12:07:52 | INFO     | main:__init__:42 - Dispositivo: cpu
2025-08-05 12:07:52 | INFO     | main:run_full_pipeline:159 - Iniciando pipeline completo de detecção de fraude
2025-08-05 12:07:52 | INFO     | main:run_full_pipeline:165 - Etapa 1: Carregamento e processamento de dados
2025-08-05 12:07:52 | INFO     | main:setup_data_pipeline:50 - Pipeline de dados configurado
2025-08-05 12:07:52 | INFO     | src.utils:__exit__:322 - Configuração do pipeline de dados executado em 0.00s
2025-08-05 12:07:52 | INFO     | src.data:load_data:88 - Carregando dados de transação...
2025-08-05 12:07:52 | INFO     | src.data:load_data:102 - Carregando dados de identidade...
2025-08-05 12:07:52 | INFO     | src.data:load_data:119 - Dados carregados - Treino: 1000, Teste: 1000
2025-08-05 12:07:52 | INFO     | src.utils:__exit__:322 - Carregamento de dados executado em 0.06s
2025-08-05 12:07:53 | INFO     | src.data:engineer_features:210 - Features processadas: 448 colunas
2025-08-05 12:07:53 | INFO     | src.utils:__exit__:322 - Engenharia de features executado em 0.22s
2025-08-05 12:07:53 | INFO     | src.data:engineer_features:210 - Features processadas: 447 colunas
2025-08-05 12:07:53 | INFO     | src.utils:__exit__:322 - Engenharia de features executado em 0.19s
2025-08-05 12:07:53 | INFO     | src.data:build_heterogeneous_graph:424 - Grafo criado com 1504 nós
2025-08-05 12:07:53 | INFO     | src.data:build_heterogeneous_graph:425 - Tipos de nós: ['transaction', 'user', 'card', 'device']
2025-08-05 12:07:53 | INFO     | src.data:build_heterogeneous_graph:426 - Tipos de arestas: [('user', 'makes', 'transaction'), ('transaction', 'uses', 'card'), ('transaction', 'from', 'device')]
2025-08-05 12:07:53 | INFO     | src.utils:__exit__:322 - Construção do grafo executado em 0.10s
2025-08-05 12:07:53 | INFO     | src.data:build_heterogeneous_graph:424 - Grafo criado com 1520 nós
2025-08-05 12:07:53 | INFO     | src.data:build_heterogeneous_graph:425 - Tipos de nós: ['transaction', 'user', 'card', 'device']
2025-08-05 12:07:53 | INFO     | src.data:build_heterogeneous_graph:426 - Tipos de arestas: [('user', 'makes', 'transaction'), ('transaction', 'uses', 'card'), ('transaction', 'from', 'device')]
2025-08-05 12:07:53 | INFO     | src.utils:__exit__:322 - Construção do grafo executado em 0.11s
2025-08-05 12:07:53 | INFO     | src.utils:__exit__:322 - Pipeline completo de dados executado em 0.68s
2025-08-05 12:07:53 | INFO     | main:load_and_process_data:64 - Dados processados: {'loader_info': {'transaction_train_shape': (1000, 394), 'transaction_test_shape': (1000, 393), 'identity_train_shape': (1000, 41), 'identity_test_shape': (1000, 41), 'fraud_rate': 0.015, 'missing_values': 159304}, 'train_graph': {'node_types': ['transaction', 'user', 'card', 'device'], 'edge_types': [('user', 'makes', 'transaction'), ('transaction', 'uses', 'card'), ('transaction', 'from', 'device')], 'num_transaction_nodes': 1000, 'num_features': 443, 'fraud_rate': 0.014999999664723873}}
2025-08-05 12:07:53 | INFO     | main:run_full_pipeline:170 - Etapa 2: Criação do modelo
2025-08-05 12:07:53 | INFO     | main:create_model:77 - Detectado grafo heterogêneo, usando modelo HeteroGNN
2025-08-05 12:07:53 | INFO     | src.models:__init__:325 - HeteroGNN construído: MEAN, 3 camadas, dim: 256
2025-08-05 12:07:53 | INFO     | main:create_model:114 - Modelo criado: HeteroGNNModel
2025-08-05 12:07:53 | INFO     | main:create_model:115 - Parâmetros: 33,154
2025-08-05 12:07:53 | INFO     | src.utils:__exit__:322 - Criação do modelo executado em 0.00s
2025-08-05 12:07:53 | INFO     | main:run_full_pipeline:175 - Etapa 3: Treinamento do modelo
2025-08-05 12:07:53 | INFO     | src.training:__init__:276 - Trainer inicializado - Dispositivo: cpu
2025-08-05 12:07:53 | INFO     | src.training:__init__:277 - Modelo: HeteroGNNModel
2025-08-05 12:07:53 | INFO     | src.training:__init__:278 - Parâmetros treináveis: 33,154
2025-08-05 12:07:53 | INFO     | src.training:train:479 - Iniciando treinamento para 5 épocas
2025-08-05 12:07:53 | INFO     | src.utils:__exit__:322 - Treinamento completo (5 épocas) executado em 0.00s
2025-08-05 12:07:53 | INFO     | src.utils:__exit__:322 - Treinamento do modelo executado em 0.00s
2025-08-05 12:07:53 | ERROR    | main:run_full_pipeline:187 - Erro no pipeline: "'transaction' not found in final x_dict. Available keys: []"
2025-08-05 12:07:53 | ERROR    | main:run_full_pipeline:189 - Traceback completo: Traceback (most recent call last):
  File "/home/pedro/Documentos/portfolio/FraudDetection/main.py", line 176, in run_full_pipeline
    training_history = self.train_model()
  File "/home/pedro/Documentos/portfolio/FraudDetection/main.py", line 134, in train_model
    history = self.trainer.train(epochs=epochs, verbose=True)
  File "/home/pedro/Documentos/portfolio/FraudDetection/src/training/__init__.py", line 487, in train
    train_loss, train_metrics = self.train_epoch()
  File "/home/pedro/Documentos/portfolio/FraudDetection/src/training/__init__.py", line 365, in train_epoch
    logits = self.model(self.data.x_dict, self.data.edge_index_dict)
  File "/home/pedro/Documentos/portfolio/FraudDetection/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/pedro/Documentos/portfolio/FraudDetection/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/pedro/Documentos/portfolio/FraudDetection/src/models/__init__.py", line 394, in forward
    raise KeyError(f"'transaction' not found in final x_dict. Available keys: {list(x_dict.keys())}")
KeyError: "'transaction' not found in final x_dict. Available keys: []"

2025-08-05 12:08:28 | INFO     | src.utils:_load_config:41 - Configuração carregada de config.yaml
2025-08-05 12:08:28 | INFO     | main:__init__:41 - Sistema de detecção de fraude inicializado
2025-08-05 12:08:28 | INFO     | main:__init__:42 - Dispositivo: cpu
2025-08-05 12:08:28 | INFO     | main:run_full_pipeline:159 - Iniciando pipeline completo de detecção de fraude
2025-08-05 12:08:28 | INFO     | main:run_full_pipeline:165 - Etapa 1: Carregamento e processamento de dados
2025-08-05 12:08:28 | INFO     | main:setup_data_pipeline:50 - Pipeline de dados configurado
2025-08-05 12:08:28 | INFO     | src.utils:__exit__:322 - Configuração do pipeline de dados executado em 0.00s
2025-08-05 12:08:28 | INFO     | src.data:load_data:88 - Carregando dados de transação...
2025-08-05 12:08:29 | INFO     | src.data:load_data:102 - Carregando dados de identidade...
2025-08-05 12:08:29 | INFO     | src.data:load_data:119 - Dados carregados - Treino: 1000, Teste: 1000
2025-08-05 12:08:29 | INFO     | src.utils:__exit__:322 - Carregamento de dados executado em 0.06s
2025-08-05 12:08:29 | INFO     | src.data:engineer_features:210 - Features processadas: 448 colunas
2025-08-05 12:08:29 | INFO     | src.utils:__exit__:322 - Engenharia de features executado em 0.22s
2025-08-05 12:08:29 | INFO     | src.data:engineer_features:210 - Features processadas: 447 colunas
2025-08-05 12:08:29 | INFO     | src.utils:__exit__:322 - Engenharia de features executado em 0.19s
2025-08-05 12:08:29 | INFO     | src.data:build_heterogeneous_graph:424 - Grafo criado com 1504 nós
2025-08-05 12:08:29 | INFO     | src.data:build_heterogeneous_graph:425 - Tipos de nós: ['transaction', 'user', 'card', 'device']
2025-08-05 12:08:29 | INFO     | src.data:build_heterogeneous_graph:426 - Tipos de arestas: [('user', 'makes', 'transaction'), ('transaction', 'uses', 'card'), ('transaction', 'from', 'device')]
2025-08-05 12:08:29 | INFO     | src.utils:__exit__:322 - Construção do grafo executado em 0.11s
2025-08-05 12:08:29 | INFO     | src.data:build_heterogeneous_graph:424 - Grafo criado com 1520 nós
2025-08-05 12:08:29 | INFO     | src.data:build_heterogeneous_graph:425 - Tipos de nós: ['transaction', 'user', 'card', 'device']
2025-08-05 12:08:29 | INFO     | src.data:build_heterogeneous_graph:426 - Tipos de arestas: [('user', 'makes', 'transaction'), ('transaction', 'uses', 'card'), ('transaction', 'from', 'device')]
2025-08-05 12:08:29 | INFO     | src.utils:__exit__:322 - Construção do grafo executado em 0.10s
2025-08-05 12:08:29 | INFO     | src.utils:__exit__:322 - Pipeline completo de dados executado em 0.68s
2025-08-05 12:08:29 | INFO     | main:load_and_process_data:64 - Dados processados: {'loader_info': {'transaction_train_shape': (1000, 394), 'transaction_test_shape': (1000, 393), 'identity_train_shape': (1000, 41), 'identity_test_shape': (1000, 41), 'fraud_rate': 0.015, 'missing_values': 159304}, 'train_graph': {'node_types': ['transaction', 'user', 'card', 'device'], 'edge_types': [('user', 'makes', 'transaction'), ('transaction', 'uses', 'card'), ('transaction', 'from', 'device')], 'num_transaction_nodes': 1000, 'num_features': 443, 'fraud_rate': 0.014999999664723873}}
2025-08-05 12:08:29 | INFO     | main:run_full_pipeline:170 - Etapa 2: Criação do modelo
2025-08-05 12:08:29 | INFO     | main:create_model:77 - Detectado grafo heterogêneo, usando modelo HeteroGNN
2025-08-05 12:08:29 | INFO     | src.models:__init__:325 - HeteroGNN construído: MEAN, 3 camadas, dim: 256
2025-08-05 12:08:29 | INFO     | main:create_model:114 - Modelo criado: HeteroGNNModel
2025-08-05 12:08:29 | INFO     | main:create_model:115 - Parâmetros: 33,154
2025-08-05 12:08:29 | INFO     | src.utils:__exit__:322 - Criação do modelo executado em 0.00s
2025-08-05 12:08:29 | INFO     | main:run_full_pipeline:175 - Etapa 3: Treinamento do modelo
2025-08-05 12:08:29 | INFO     | src.training:__init__:276 - Trainer inicializado - Dispositivo: cpu
2025-08-05 12:08:29 | INFO     | src.training:__init__:277 - Modelo: HeteroGNNModel
2025-08-05 12:08:29 | INFO     | src.training:__init__:278 - Parâmetros treináveis: 33,154
2025-08-05 12:08:29 | INFO     | src.training:train:479 - Iniciando treinamento para 5 épocas
2025-08-05 12:08:29 | INFO     | src.utils:__exit__:322 - Treinamento completo (5 épocas) executado em 0.00s
2025-08-05 12:08:29 | INFO     | src.utils:__exit__:322 - Treinamento do modelo executado em 0.00s
2025-08-05 12:08:29 | ERROR    | main:run_full_pipeline:187 - Erro no pipeline: "'transaction' not found in final x_dict. Available keys: []"
2025-08-05 12:08:29 | ERROR    | main:run_full_pipeline:189 - Traceback completo: Traceback (most recent call last):
  File "/home/pedro/Documentos/portfolio/FraudDetection/main.py", line 176, in run_full_pipeline
    training_history = self.train_model()
  File "/home/pedro/Documentos/portfolio/FraudDetection/main.py", line 134, in train_model
    history = self.trainer.train(epochs=epochs, verbose=True)
  File "/home/pedro/Documentos/portfolio/FraudDetection/src/training/__init__.py", line 487, in train
    train_loss, train_metrics = self.train_epoch()
  File "/home/pedro/Documentos/portfolio/FraudDetection/src/training/__init__.py", line 365, in train_epoch
    logits = self.model(self.data.x_dict, self.data.edge_index_dict)
  File "/home/pedro/Documentos/portfolio/FraudDetection/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/pedro/Documentos/portfolio/FraudDetection/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/pedro/Documentos/portfolio/FraudDetection/src/models/__init__.py", line 399, in forward
    raise KeyError(f"'transaction' not found in final x_dict. Available keys: {list(x_dict.keys())}")
KeyError: "'transaction' not found in final x_dict. Available keys: []"

2025-08-05 12:10:34 | INFO     | src.utils:_load_config:41 - Configuração carregada de config.yaml
2025-08-05 12:10:34 | INFO     | main:__init__:41 - Sistema de detecção de fraude inicializado
2025-08-05 12:10:34 | INFO     | main:__init__:42 - Dispositivo: cpu
2025-08-05 12:10:34 | INFO     | main:run_full_pipeline:159 - Iniciando pipeline completo de detecção de fraude
2025-08-05 12:10:34 | INFO     | main:run_full_pipeline:165 - Etapa 1: Carregamento e processamento de dados
2025-08-05 12:10:34 | INFO     | main:setup_data_pipeline:50 - Pipeline de dados configurado
2025-08-05 12:10:34 | INFO     | src.utils:__exit__:322 - Configuração do pipeline de dados executado em 0.00s
2025-08-05 12:10:34 | INFO     | src.data:load_data:88 - Carregando dados de transação...
2025-08-05 12:10:34 | INFO     | src.data:load_data:102 - Carregando dados de identidade...
2025-08-05 12:10:34 | INFO     | src.data:load_data:119 - Dados carregados - Treino: 1000, Teste: 1000
2025-08-05 12:10:34 | INFO     | src.utils:__exit__:322 - Carregamento de dados executado em 0.05s
2025-08-05 12:10:34 | INFO     | src.data:engineer_features:210 - Features processadas: 448 colunas
2025-08-05 12:10:34 | INFO     | src.utils:__exit__:322 - Engenharia de features executado em 0.20s
2025-08-05 12:10:34 | INFO     | src.data:engineer_features:210 - Features processadas: 447 colunas
2025-08-05 12:10:34 | INFO     | src.utils:__exit__:322 - Engenharia de features executado em 0.19s
2025-08-05 12:10:35 | INFO     | src.data:build_heterogeneous_graph:424 - Grafo criado com 1504 nós
2025-08-05 12:10:35 | INFO     | src.data:build_heterogeneous_graph:425 - Tipos de nós: ['transaction', 'user', 'card', 'device']
2025-08-05 12:10:35 | INFO     | src.data:build_heterogeneous_graph:426 - Tipos de arestas: [('user', 'makes', 'transaction'), ('transaction', 'uses', 'card'), ('transaction', 'from', 'device')]
2025-08-05 12:10:35 | INFO     | src.utils:__exit__:322 - Construção do grafo executado em 0.11s
2025-08-05 12:10:35 | INFO     | src.data:build_heterogeneous_graph:424 - Grafo criado com 1520 nós
2025-08-05 12:10:35 | INFO     | src.data:build_heterogeneous_graph:425 - Tipos de nós: ['transaction', 'user', 'card', 'device']
2025-08-05 12:10:35 | INFO     | src.data:build_heterogeneous_graph:426 - Tipos de arestas: [('user', 'makes', 'transaction'), ('transaction', 'uses', 'card'), ('transaction', 'from', 'device')]
2025-08-05 12:10:35 | INFO     | src.utils:__exit__:322 - Construção do grafo executado em 0.10s
2025-08-05 12:10:35 | INFO     | src.utils:__exit__:322 - Pipeline completo de dados executado em 0.65s
2025-08-05 12:10:35 | INFO     | main:load_and_process_data:64 - Dados processados: {'loader_info': {'transaction_train_shape': (1000, 394), 'transaction_test_shape': (1000, 393), 'identity_train_shape': (1000, 41), 'identity_test_shape': (1000, 41), 'fraud_rate': 0.015, 'missing_values': 159304}, 'train_graph': {'node_types': ['transaction', 'user', 'card', 'device'], 'edge_types': [('user', 'makes', 'transaction'), ('transaction', 'uses', 'card'), ('transaction', 'from', 'device')], 'num_transaction_nodes': 1000, 'num_features': 443, 'fraud_rate': 0.014999999664723873}}
2025-08-05 12:10:35 | INFO     | main:run_full_pipeline:170 - Etapa 2: Criação do modelo
2025-08-05 12:10:35 | INFO     | main:create_model:77 - Detectado grafo heterogêneo, usando modelo HeteroGNN
2025-08-05 12:10:35 | INFO     | src.models:__init__:325 - HeteroGNN construído: MEAN, 3 camadas, dim: 256
2025-08-05 12:10:35 | INFO     | main:create_model:114 - Modelo criado: HeteroGNNModel
2025-08-05 12:10:35 | INFO     | src.utils:__exit__:322 - Criação do modelo executado em 0.03s
2025-08-05 12:10:35 | ERROR    | main:run_full_pipeline:187 - Erro no pipeline: Attempted to use an uninitialized parameter in <method 'numel' of 'torch._C.TensorBase' objects>. This error happens when you are using a `LazyModule` or explicitly manipulating `torch.nn.parameter.UninitializedParameter` objects. When using LazyModules Call `forward` with a dummy batch to initialize the parameters before calling torch functions
2025-08-05 12:10:35 | ERROR    | main:run_full_pipeline:189 - Traceback completo: Traceback (most recent call last):
  File "/home/pedro/Documentos/portfolio/FraudDetection/main.py", line 171, in run_full_pipeline
    self.create_model()
  File "/home/pedro/Documentos/portfolio/FraudDetection/main.py", line 115, in create_model
    logger.info(f"Parâmetros: {sum(p.numel() for p in self.model.parameters()):,}")
  File "/home/pedro/Documentos/portfolio/FraudDetection/main.py", line 115, in <genexpr>
    logger.info(f"Parâmetros: {sum(p.numel() for p in self.model.parameters()):,}")
  File "/home/pedro/Documentos/portfolio/FraudDetection/.venv/lib/python3.10/site-packages/torch/nn/parameter.py", line 168, in __torch_function__
    raise ValueError(
ValueError: Attempted to use an uninitialized parameter in <method 'numel' of 'torch._C.TensorBase' objects>. This error happens when you are using a `LazyModule` or explicitly manipulating `torch.nn.parameter.UninitializedParameter` objects. When using LazyModules Call `forward` with a dummy batch to initialize the parameters before calling torch functions

2025-08-05 12:14:36 | INFO     | src.utils:_load_config:41 - Configuração carregada de config.yaml
2025-08-05 12:14:36 | INFO     | main:__init__:41 - Sistema de detecção de fraude inicializado
2025-08-05 12:14:36 | INFO     | main:__init__:42 - Dispositivo: cpu
2025-08-05 12:14:36 | INFO     | main:run_full_pipeline:164 - Iniciando pipeline completo de detecção de fraude
2025-08-05 12:14:36 | INFO     | main:run_full_pipeline:170 - Etapa 1: Carregamento e processamento de dados
2025-08-05 12:14:36 | INFO     | main:setup_data_pipeline:50 - Pipeline de dados configurado
2025-08-05 12:14:36 | INFO     | src.utils:__exit__:322 - Configuração do pipeline de dados executado em 0.00s
2025-08-05 12:14:36 | INFO     | src.data:load_data:88 - Carregando dados de transação...
2025-08-05 12:14:36 | INFO     | src.data:load_data:102 - Carregando dados de identidade...
2025-08-05 12:14:36 | INFO     | src.data:load_data:119 - Dados carregados - Treino: 1000, Teste: 1000
2025-08-05 12:14:36 | INFO     | src.utils:__exit__:322 - Carregamento de dados executado em 0.05s
2025-08-05 12:14:36 | INFO     | src.data:engineer_features:210 - Features processadas: 448 colunas
2025-08-05 12:14:36 | INFO     | src.utils:__exit__:322 - Engenharia de features executado em 0.21s
2025-08-05 12:14:36 | INFO     | src.data:engineer_features:210 - Features processadas: 447 colunas
2025-08-05 12:14:36 | INFO     | src.utils:__exit__:322 - Engenharia de features executado em 0.19s
2025-08-05 12:14:37 | INFO     | src.data:build_heterogeneous_graph:424 - Grafo criado com 1504 nós
2025-08-05 12:14:37 | INFO     | src.data:build_heterogeneous_graph:425 - Tipos de nós: ['transaction', 'user', 'card', 'device']
2025-08-05 12:14:37 | INFO     | src.data:build_heterogeneous_graph:426 - Tipos de arestas: [('user', 'makes', 'transaction'), ('transaction', 'uses', 'card'), ('transaction', 'from', 'device')]
2025-08-05 12:14:37 | INFO     | src.utils:__exit__:322 - Construção do grafo executado em 0.11s
2025-08-05 12:14:37 | INFO     | src.data:build_heterogeneous_graph:424 - Grafo criado com 1520 nós
2025-08-05 12:14:37 | INFO     | src.data:build_heterogeneous_graph:425 - Tipos de nós: ['transaction', 'user', 'card', 'device']
2025-08-05 12:14:37 | INFO     | src.data:build_heterogeneous_graph:426 - Tipos de arestas: [('user', 'makes', 'transaction'), ('transaction', 'uses', 'card'), ('transaction', 'from', 'device')]
2025-08-05 12:14:37 | INFO     | src.utils:__exit__:322 - Construção do grafo executado em 0.10s
2025-08-05 12:14:37 | INFO     | src.utils:__exit__:322 - Pipeline completo de dados executado em 0.65s
2025-08-05 12:14:37 | INFO     | main:load_and_process_data:64 - Dados processados: {'loader_info': {'transaction_train_shape': (1000, 394), 'transaction_test_shape': (1000, 393), 'identity_train_shape': (1000, 41), 'identity_test_shape': (1000, 41), 'fraud_rate': 0.015, 'missing_values': 159304}, 'train_graph': {'node_types': ['transaction', 'user', 'card', 'device'], 'edge_types': [('user', 'makes', 'transaction'), ('transaction', 'uses', 'card'), ('transaction', 'from', 'device')], 'num_transaction_nodes': 1000, 'num_features': 443, 'fraud_rate': 0.014999999664723873}}
2025-08-05 12:14:37 | INFO     | main:run_full_pipeline:175 - Etapa 2: Criação do modelo
2025-08-05 12:14:37 | INFO     | main:create_model:77 - Detectado grafo heterogêneo, usando modelo HeteroGNN
2025-08-05 12:14:37 | INFO     | src.models:__init__:325 - HeteroGNN construído: SAGE, 3 camadas, dim: 256
2025-08-05 12:14:37 | INFO     | main:create_model:114 - Modelo criado: HeteroGNNModel
2025-08-05 12:14:37 | INFO     | main:create_model:118 - Parâmetros inicializados: 35,458
2025-08-05 12:14:37 | INFO     | src.utils:__exit__:322 - Criação do modelo executado em 0.02s
2025-08-05 12:14:37 | INFO     | main:run_full_pipeline:180 - Etapa 3: Treinamento do modelo
2025-08-05 12:14:37 | INFO     | src.training:__init__:276 - Trainer inicializado - Dispositivo: cpu
2025-08-05 12:14:37 | INFO     | src.training:__init__:277 - Modelo: HeteroGNNModel
2025-08-05 12:14:37 | INFO     | src.utils:__exit__:322 - Treinamento do modelo executado em 0.00s
2025-08-05 12:14:37 | ERROR    | main:run_full_pipeline:192 - Erro no pipeline: Attempted to use an uninitialized parameter in <method 'numel' of 'torch._C.TensorBase' objects>. This error happens when you are using a `LazyModule` or explicitly manipulating `torch.nn.parameter.UninitializedParameter` objects. When using LazyModules Call `forward` with a dummy batch to initialize the parameters before calling torch functions
2025-08-05 12:14:37 | ERROR    | main:run_full_pipeline:194 - Traceback completo: Traceback (most recent call last):
  File "/home/pedro/Documentos/portfolio/FraudDetection/main.py", line 181, in run_full_pipeline
    training_history = self.train_model()
  File "/home/pedro/Documentos/portfolio/FraudDetection/main.py", line 131, in train_model
    self.trainer = GNNTrainer(
  File "/home/pedro/Documentos/portfolio/FraudDetection/src/training/__init__.py", line 278, in __init__
    logger.info(f"Parâmetros treináveis: {sum(p.numel() for p in model.parameters() if p.requires_grad):,}")
  File "/home/pedro/Documentos/portfolio/FraudDetection/src/training/__init__.py", line 278, in <genexpr>
    logger.info(f"Parâmetros treináveis: {sum(p.numel() for p in model.parameters() if p.requires_grad):,}")
  File "/home/pedro/Documentos/portfolio/FraudDetection/.venv/lib/python3.10/site-packages/torch/nn/parameter.py", line 168, in __torch_function__
    raise ValueError(
ValueError: Attempted to use an uninitialized parameter in <method 'numel' of 'torch._C.TensorBase' objects>. This error happens when you are using a `LazyModule` or explicitly manipulating `torch.nn.parameter.UninitializedParameter` objects. When using LazyModules Call `forward` with a dummy batch to initialize the parameters before calling torch functions

2025-08-05 12:17:09 | INFO     | src.utils:_load_config:41 - Configuração carregada de config.yaml
2025-08-05 12:17:09 | INFO     | main:__init__:41 - Sistema de detecção de fraude inicializado
2025-08-05 12:17:09 | INFO     | main:__init__:42 - Dispositivo: cpu
2025-08-05 12:17:09 | INFO     | main:run_full_pipeline:164 - Iniciando pipeline completo de detecção de fraude
2025-08-05 12:17:09 | INFO     | main:run_full_pipeline:170 - Etapa 1: Carregamento e processamento de dados
2025-08-05 12:17:09 | INFO     | main:setup_data_pipeline:50 - Pipeline de dados configurado
2025-08-05 12:17:09 | INFO     | src.utils:__exit__:322 - Configuração do pipeline de dados executado em 0.00s
2025-08-05 12:17:09 | INFO     | src.data:load_data:88 - Carregando dados de transação...
2025-08-05 12:17:09 | INFO     | src.data:load_data:102 - Carregando dados de identidade...
2025-08-05 12:17:09 | INFO     | src.data:load_data:119 - Dados carregados - Treino: 1000, Teste: 1000
2025-08-05 12:17:09 | INFO     | src.utils:__exit__:322 - Carregamento de dados executado em 0.05s
2025-08-05 12:17:09 | INFO     | src.data:engineer_features:210 - Features processadas: 448 colunas
2025-08-05 12:17:09 | INFO     | src.utils:__exit__:322 - Engenharia de features executado em 0.21s
2025-08-05 12:17:10 | INFO     | src.data:engineer_features:210 - Features processadas: 447 colunas
2025-08-05 12:17:10 | INFO     | src.utils:__exit__:322 - Engenharia de features executado em 0.20s
2025-08-05 12:17:10 | INFO     | src.data:build_heterogeneous_graph:424 - Grafo criado com 1504 nós
2025-08-05 12:17:10 | INFO     | src.data:build_heterogeneous_graph:425 - Tipos de nós: ['transaction', 'user', 'card', 'device']
2025-08-05 12:17:10 | INFO     | src.data:build_heterogeneous_graph:426 - Tipos de arestas: [('user', 'makes', 'transaction'), ('transaction', 'uses', 'card'), ('transaction', 'from', 'device')]
2025-08-05 12:17:10 | INFO     | src.utils:__exit__:322 - Construção do grafo executado em 0.11s
2025-08-05 12:17:10 | INFO     | src.data:build_heterogeneous_graph:424 - Grafo criado com 1520 nós
2025-08-05 12:17:10 | INFO     | src.data:build_heterogeneous_graph:425 - Tipos de nós: ['transaction', 'user', 'card', 'device']
2025-08-05 12:17:10 | INFO     | src.data:build_heterogeneous_graph:426 - Tipos de arestas: [('user', 'makes', 'transaction'), ('transaction', 'uses', 'card'), ('transaction', 'from', 'device')]
2025-08-05 12:17:10 | INFO     | src.utils:__exit__:322 - Construção do grafo executado em 0.10s
2025-08-05 12:17:10 | INFO     | src.utils:__exit__:322 - Pipeline completo de dados executado em 0.67s
2025-08-05 12:17:10 | INFO     | main:load_and_process_data:64 - Dados processados: {'loader_info': {'transaction_train_shape': (1000, 394), 'transaction_test_shape': (1000, 393), 'identity_train_shape': (1000, 41), 'identity_test_shape': (1000, 41), 'fraud_rate': 0.015, 'missing_values': 159304}, 'train_graph': {'node_types': ['transaction', 'user', 'card', 'device'], 'edge_types': [('user', 'makes', 'transaction'), ('transaction', 'uses', 'card'), ('transaction', 'from', 'device')], 'num_transaction_nodes': 1000, 'num_features': 443, 'fraud_rate': 0.014999999664723873}}
2025-08-05 12:17:10 | INFO     | main:run_full_pipeline:175 - Etapa 2: Criação do modelo
2025-08-05 12:17:10 | INFO     | main:create_model:77 - Detectado grafo heterogêneo, usando modelo HeteroGNN
2025-08-05 12:17:10 | INFO     | src.models:__init__:325 - HeteroGNN construído: SAGE, 3 camadas, dim: 256
2025-08-05 12:17:10 | INFO     | main:create_model:114 - Modelo criado: HeteroGNNModel
2025-08-05 12:17:10 | INFO     | main:create_model:118 - Parâmetros inicializados: 35,458
2025-08-05 12:17:10 | INFO     | src.utils:__exit__:322 - Criação do modelo executado em 0.02s
2025-08-05 12:17:10 | INFO     | main:run_full_pipeline:180 - Etapa 3: Treinamento do modelo
2025-08-05 12:17:10 | INFO     | src.training:__init__:276 - Trainer inicializado - Dispositivo: cpu
2025-08-05 12:17:10 | INFO     | src.training:__init__:277 - Modelo: HeteroGNNModel
2025-08-05 12:17:10 | INFO     | src.training:__init__:283 - Inicializando parâmetros lazy do HeteroGNN...
2025-08-05 12:17:10 | WARNING  | src.training:__init__:289 - Não foi possível inicializar parâmetros lazy: 'NoneType' object has no attribute 'dim'
2025-08-05 12:17:10 | WARNING  | src.training:__init__:296 - Não foi possível contar parâmetros: Attempted to use an uninitialized parameter in <method 'numel' of 'torch._C.TensorBase' objects>. This error happens when you are using a `LazyModule` or explicitly manipulating `torch.nn.parameter.UninitializedParameter` objects. When using LazyModules Call `forward` with a dummy batch to initialize the parameters before calling torch functions
2025-08-05 12:17:10 | INFO     | src.training:train:497 - Iniciando treinamento para 5 épocas
2025-08-05 12:17:10 | INFO     | src.utils:__exit__:322 - Treinamento completo (5 épocas) executado em 0.02s
2025-08-05 12:17:10 | INFO     | src.utils:__exit__:322 - Treinamento do modelo executado em 0.04s
2025-08-05 12:17:10 | ERROR    | main:run_full_pipeline:192 - Erro no pipeline: 'NoneType' object has no attribute 'dim'
2025-08-05 12:17:10 | ERROR    | main:run_full_pipeline:194 - Traceback completo: Traceback (most recent call last):
  File "/home/pedro/Documentos/portfolio/FraudDetection/main.py", line 181, in run_full_pipeline
    training_history = self.train_model()
  File "/home/pedro/Documentos/portfolio/FraudDetection/main.py", line 139, in train_model
    history = self.trainer.train(epochs=epochs, verbose=True)
  File "/home/pedro/Documentos/portfolio/FraudDetection/src/training/__init__.py", line 505, in train
    train_loss, train_metrics = self.train_epoch()
  File "/home/pedro/Documentos/portfolio/FraudDetection/src/training/__init__.py", line 383, in train_epoch
    logits = self.model(self.data.x_dict, self.data.edge_index_dict)
  File "/home/pedro/Documentos/portfolio/FraudDetection/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/pedro/Documentos/portfolio/FraudDetection/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/pedro/Documentos/portfolio/FraudDetection/src/models/__init__.py", line 386, in forward
    x_dict = conv(x_dict, edge_index_dict)
  File "/home/pedro/Documentos/portfolio/FraudDetection/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/pedro/Documentos/portfolio/FraudDetection/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/pedro/Documentos/portfolio/FraudDetection/.venv/lib/python3.10/site-packages/torch_geometric/nn/conv/hetero_conv.py", line 158, in forward
    out = conv(*args, **kwargs)
  File "/home/pedro/Documentos/portfolio/FraudDetection/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/pedro/Documentos/portfolio/FraudDetection/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/pedro/Documentos/portfolio/FraudDetection/.venv/lib/python3.10/site-packages/torch_geometric/nn/conv/sage_conv.py", line 134, in forward
    out = self.propagate(edge_index, x=x, size=size)
  File "/tmp/torch_geometric.nn.conv.sage_conv_SAGEConv_propagate_2nded9e4.py", line 229, in propagate
    out = self.aggregate(
  File "/home/pedro/Documentos/portfolio/FraudDetection/.venv/lib/python3.10/site-packages/torch_geometric/nn/conv/message_passing.py", line 594, in aggregate
    return self.aggr_module(inputs, index, ptr=ptr, dim_size=dim_size,
  File "/home/pedro/Documentos/portfolio/FraudDetection/.venv/lib/python3.10/site-packages/torch_geometric/experimental.py", line 117, in wrapper
    return func(*args, **kwargs)
  File "/home/pedro/Documentos/portfolio/FraudDetection/.venv/lib/python3.10/site-packages/torch_geometric/nn/aggr/base.py", line 112, in __call__
    if dim >= x.dim() or dim < -x.dim():
AttributeError: 'NoneType' object has no attribute 'dim'

2025-08-05 12:23:00 | INFO     | src.utils:_load_config:41 - Configuração carregada de config.yaml
2025-08-05 12:23:00 | INFO     | main:__init__:41 - Sistema de detecção de fraude inicializado
2025-08-05 12:23:00 | INFO     | main:__init__:42 - Dispositivo: cpu
2025-08-05 12:23:00 | INFO     | main:run_full_pipeline:164 - Iniciando pipeline completo de detecção de fraude
2025-08-05 12:23:00 | INFO     | main:run_full_pipeline:170 - Etapa 1: Carregamento e processamento de dados
2025-08-05 12:23:00 | INFO     | main:setup_data_pipeline:50 - Pipeline de dados configurado
2025-08-05 12:23:00 | INFO     | src.utils:__exit__:322 - Configuração do pipeline de dados executado em 0.00s
2025-08-05 12:23:00 | INFO     | src.data:load_data:88 - Carregando dados de transação...
2025-08-05 12:23:00 | INFO     | src.data:load_data:102 - Carregando dados de identidade...
2025-08-05 12:23:00 | INFO     | src.data:load_data:119 - Dados carregados - Treino: 1000, Teste: 1000
2025-08-05 12:23:00 | INFO     | src.utils:__exit__:322 - Carregamento de dados executado em 0.05s
2025-08-05 12:23:00 | INFO     | src.data:engineer_features:210 - Features processadas: 448 colunas
2025-08-05 12:23:00 | INFO     | src.utils:__exit__:322 - Engenharia de features executado em 0.21s
2025-08-05 12:23:00 | INFO     | src.data:engineer_features:210 - Features processadas: 447 colunas
2025-08-05 12:23:00 | INFO     | src.utils:__exit__:322 - Engenharia de features executado em 0.19s
2025-08-05 12:23:01 | INFO     | src.data:build_heterogeneous_graph:424 - Grafo criado com 1504 nós
2025-08-05 12:23:01 | INFO     | src.data:build_heterogeneous_graph:425 - Tipos de nós: ['transaction', 'user', 'card', 'device']
2025-08-05 12:23:01 | INFO     | src.data:build_heterogeneous_graph:426 - Tipos de arestas: [('user', 'makes', 'transaction'), ('transaction', 'uses', 'card'), ('transaction', 'from', 'device')]
2025-08-05 12:23:01 | INFO     | src.utils:__exit__:322 - Construção do grafo executado em 0.10s
2025-08-05 12:23:01 | INFO     | src.data:build_heterogeneous_graph:424 - Grafo criado com 1520 nós
2025-08-05 12:23:01 | INFO     | src.data:build_heterogeneous_graph:425 - Tipos de nós: ['transaction', 'user', 'card', 'device']
2025-08-05 12:23:01 | INFO     | src.data:build_heterogeneous_graph:426 - Tipos de arestas: [('user', 'makes', 'transaction'), ('transaction', 'uses', 'card'), ('transaction', 'from', 'device')]
2025-08-05 12:23:01 | INFO     | src.utils:__exit__:322 - Construção do grafo executado em 0.10s
2025-08-05 12:23:01 | INFO     | src.utils:__exit__:322 - Pipeline completo de dados executado em 0.65s
2025-08-05 12:23:01 | INFO     | main:load_and_process_data:64 - Dados processados: {'loader_info': {'transaction_train_shape': (1000, 394), 'transaction_test_shape': (1000, 393), 'identity_train_shape': (1000, 41), 'identity_test_shape': (1000, 41), 'fraud_rate': 0.015, 'missing_values': 159304}, 'train_graph': {'node_types': ['transaction', 'user', 'card', 'device'], 'edge_types': [('user', 'makes', 'transaction'), ('transaction', 'uses', 'card'), ('transaction', 'from', 'device')], 'num_transaction_nodes': 1000, 'num_features': 443, 'fraud_rate': 0.014999999664723873}}
2025-08-05 12:23:01 | INFO     | main:run_full_pipeline:175 - Etapa 2: Criação do modelo
2025-08-05 12:23:01 | INFO     | main:create_model:77 - Detectado grafo heterogêneo, usando modelo HeteroGNN
2025-08-05 12:23:01 | INFO     | src.models:__init__:325 - HeteroGNN construído: SAGE, 3 camadas, dim: 256
2025-08-05 12:23:01 | INFO     | main:create_model:114 - Modelo criado: HeteroGNNModel
2025-08-05 12:23:01 | INFO     | main:create_model:118 - Parâmetros inicializados: 35,458
2025-08-05 12:23:01 | INFO     | src.utils:__exit__:322 - Criação do modelo executado em 0.03s
2025-08-05 12:23:01 | INFO     | main:run_full_pipeline:180 - Etapa 3: Treinamento do modelo
2025-08-05 12:23:01 | INFO     | src.training:__init__:276 - Trainer inicializado - Dispositivo: cpu
2025-08-05 12:23:01 | INFO     | src.training:__init__:277 - Modelo: HeteroGNNModel
2025-08-05 12:23:01 | INFO     | src.training:__init__:283 - Inicializando parâmetros lazy do HeteroGNN...
2025-08-05 12:23:01 | INFO     | src.training:__init__:287 - Parâmetros lazy inicializados com sucesso
2025-08-05 12:23:01 | INFO     | src.training:__init__:294 - Parâmetros treináveis: 1,047,426
2025-08-05 12:23:01 | INFO     | src.training:train:497 - Iniciando treinamento para 5 épocas
2025-08-05 12:23:01 | INFO     | src.training:train:539 - Época 1/5 - Train Loss: 0.1416 - Val F1: 0.9850 - Val AUC: 0.4369
2025-08-05 12:23:01 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 12:23:01 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 12:23:01 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 12:23:01 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 12:23:01 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 12:23:01 | INFO     | src.utils:__exit__:322 - Treinamento completo (5 épocas) executado em 0.35s
2025-08-05 12:23:01 | INFO     | src.training:train:557 - Melhor modelo carregado (F1: 0.9850)
2025-08-05 12:23:01 | INFO     | src.training:save_model:590 - Modelo salvo em results/models/fraud_detection_model_1754407381.pt
2025-08-05 12:23:01 | INFO     | main:train_model:143 - Treinamento concluído: {'epochs_trained': 5, 'best_epoch': 1, 'best_val_f1': 0.9850251256281406, 'best_val_auc': 0.43686868686868685, 'final_train_loss': 0.05930690839886665, 'final_val_loss': 0.034033071249723434, 'total_parameters': 1047426, 'trainable_parameters': 1047426}
2025-08-05 12:23:01 | INFO     | src.utils:__exit__:322 - Treinamento do modelo executado em 0.38s
2025-08-05 12:23:01 | INFO     | main:run_full_pipeline:185 - Etapa 4: Avaliação do modelo
2025-08-05 12:23:01 | INFO     | src.utils:__exit__:322 - Avaliação do modelo executado em 0.00s
2025-08-05 12:23:01 | INFO     | main:run_full_pipeline:189 - Pipeline completo executado com sucesso!
2025-08-05 12:26:24 | INFO     | src.utils:_load_config:41 - Configuração carregada de config.yaml
2025-08-05 12:26:24 | INFO     | main:__init__:41 - Sistema de detecção de fraude inicializado
2025-08-05 12:26:24 | INFO     | main:__init__:42 - Dispositivo: cpu
2025-08-05 12:26:24 | INFO     | main:run_full_pipeline:164 - Iniciando pipeline completo de detecção de fraude
2025-08-05 12:26:24 | INFO     | main:run_full_pipeline:170 - Etapa 1: Carregamento e processamento de dados
2025-08-05 12:26:24 | INFO     | main:setup_data_pipeline:50 - Pipeline de dados configurado
2025-08-05 12:26:24 | INFO     | src.utils:__exit__:322 - Configuração do pipeline de dados executado em 0.00s
2025-08-05 12:26:24 | INFO     | src.data:load_data:88 - Carregando dados de transação...
2025-08-05 12:26:24 | INFO     | src.data:load_data:102 - Carregando dados de identidade...
2025-08-05 12:26:24 | INFO     | src.data:load_data:119 - Dados carregados - Treino: 1000, Teste: 1000
2025-08-05 12:26:24 | INFO     | src.utils:__exit__:322 - Carregamento de dados executado em 0.14s
2025-08-05 12:26:25 | INFO     | src.data:engineer_features:210 - Features processadas: 448 colunas
2025-08-05 12:26:25 | INFO     | src.utils:__exit__:322 - Engenharia de features executado em 0.20s
2025-08-05 12:26:25 | INFO     | src.data:engineer_features:210 - Features processadas: 447 colunas
2025-08-05 12:26:25 | INFO     | src.utils:__exit__:322 - Engenharia de features executado em 0.20s
2025-08-05 12:26:25 | INFO     | src.data:build_heterogeneous_graph:424 - Grafo criado com 1504 nós
2025-08-05 12:26:25 | INFO     | src.data:build_heterogeneous_graph:425 - Tipos de nós: ['transaction', 'user', 'card', 'device']
2025-08-05 12:26:25 | INFO     | src.data:build_heterogeneous_graph:426 - Tipos de arestas: [('user', 'makes', 'transaction'), ('transaction', 'uses', 'card'), ('transaction', 'from', 'device')]
2025-08-05 12:26:25 | INFO     | src.utils:__exit__:322 - Construção do grafo executado em 0.10s
2025-08-05 12:26:25 | INFO     | src.data:build_heterogeneous_graph:424 - Grafo criado com 1520 nós
2025-08-05 12:26:25 | INFO     | src.data:build_heterogeneous_graph:425 - Tipos de nós: ['transaction', 'user', 'card', 'device']
2025-08-05 12:26:25 | INFO     | src.data:build_heterogeneous_graph:426 - Tipos de arestas: [('user', 'makes', 'transaction'), ('transaction', 'uses', 'card'), ('transaction', 'from', 'device')]
2025-08-05 12:26:25 | INFO     | src.utils:__exit__:322 - Construção do grafo executado em 0.10s
2025-08-05 12:26:25 | INFO     | src.utils:__exit__:322 - Pipeline completo de dados executado em 0.74s
2025-08-05 12:26:25 | INFO     | main:load_and_process_data:64 - Dados processados: {'loader_info': {'transaction_train_shape': (1000, 394), 'transaction_test_shape': (1000, 393), 'identity_train_shape': (1000, 41), 'identity_test_shape': (1000, 41), 'fraud_rate': 0.015, 'missing_values': 159304}, 'train_graph': {'node_types': ['transaction', 'user', 'card', 'device'], 'edge_types': [('user', 'makes', 'transaction'), ('transaction', 'uses', 'card'), ('transaction', 'from', 'device')], 'num_transaction_nodes': 1000, 'num_features': 443, 'fraud_rate': 0.014999999664723873}}
2025-08-05 12:26:25 | INFO     | main:run_full_pipeline:175 - Etapa 2: Criação do modelo
2025-08-05 12:26:25 | INFO     | main:create_model:77 - Detectado grafo heterogêneo, usando modelo HeteroGNN
2025-08-05 12:26:25 | INFO     | src.models:__init__:325 - HeteroGNN construído: SAGE, 3 camadas, dim: 256
2025-08-05 12:26:25 | INFO     | main:create_model:114 - Modelo criado: HeteroGNNModel
2025-08-05 12:26:25 | INFO     | main:create_model:118 - Parâmetros inicializados: 35,458
2025-08-05 12:26:25 | INFO     | src.utils:__exit__:322 - Criação do modelo executado em 0.03s
2025-08-05 12:26:25 | INFO     | main:run_full_pipeline:180 - Etapa 3: Treinamento do modelo
2025-08-05 12:26:25 | INFO     | src.training:__init__:276 - Trainer inicializado - Dispositivo: cpu
2025-08-05 12:26:25 | INFO     | src.training:__init__:277 - Modelo: HeteroGNNModel
2025-08-05 12:26:25 | INFO     | src.training:__init__:283 - Inicializando parâmetros lazy do HeteroGNN...
2025-08-05 12:26:25 | INFO     | src.training:__init__:287 - Parâmetros lazy inicializados com sucesso
2025-08-05 12:26:25 | INFO     | src.training:__init__:294 - Parâmetros treináveis: 1,047,426
2025-08-05 12:26:25 | INFO     | src.training:train:489 - Iniciando treinamento para 5 épocas
2025-08-05 12:26:25 | INFO     | src.training:train:531 - Época 1/5 - Train Loss: 0.1444 - Val F1: 0.9850 - Val AUC: 0.6490
2025-08-05 12:26:25 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 12:26:25 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 12:26:25 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 12:26:25 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 12:26:25 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 12:26:25 | INFO     | src.utils:__exit__:322 - Treinamento completo (5 épocas) executado em 0.34s
2025-08-05 12:26:25 | INFO     | src.training:train:549 - Melhor modelo carregado (F1: 0.9850)
2025-08-05 12:26:25 | INFO     | src.training:save_model:582 - Modelo salvo em results/models/fraud_detection_model_1754407585.pt
2025-08-05 12:26:25 | INFO     | main:train_model:143 - Treinamento concluído: {'epochs_trained': 5, 'best_epoch': 1, 'best_val_f1': 0.9850251256281406, 'best_val_auc': 0.648989898989899, 'final_train_loss': 0.051785536110401154, 'final_val_loss': 0.02702444978058338, 'total_parameters': 1047426, 'trainable_parameters': 1047426}
2025-08-05 12:26:25 | INFO     | src.utils:__exit__:322 - Treinamento do modelo executado em 0.39s
2025-08-05 12:26:25 | INFO     | main:run_full_pipeline:185 - Etapa 4: Avaliação do modelo
2025-08-05 12:26:25 | INFO     | src.utils:__exit__:322 - Avaliação do modelo executado em 0.00s
2025-08-05 12:26:25 | INFO     | main:run_full_pipeline:189 - Pipeline completo executado com sucesso!
2025-08-05 15:08:11 | INFO     | src.utils:_load_config:41 - Configuração carregada de config.yaml
2025-08-05 15:08:11 | INFO     | main:__init__:41 - Sistema de detecção de fraude inicializado
2025-08-05 15:08:11 | INFO     | main:__init__:42 - Dispositivo: cpu
2025-08-05 15:08:11 | INFO     | main:setup_data_pipeline:50 - Pipeline de dados configurado
2025-08-05 15:08:11 | INFO     | src.utils:__exit__:322 - Configuração do pipeline de dados executado em 0.00s
2025-08-05 15:08:11 | INFO     | src.data:load_data:88 - Carregando dados de transação...
2025-08-05 15:08:13 | INFO     | src.data:load_data:102 - Carregando dados de identidade...
2025-08-05 15:08:13 | INFO     | src.data:load_data:119 - Dados carregados - Treino: 50000, Teste: 50000
2025-08-05 15:08:13 | INFO     | src.utils:__exit__:322 - Carregamento de dados executado em 2.66s
2025-08-05 15:08:19 | INFO     | src.data:engineer_features:210 - Features processadas: 448 colunas
2025-08-05 15:08:19 | INFO     | src.utils:__exit__:322 - Engenharia de features executado em 5.86s
2025-08-05 15:08:23 | INFO     | src.data:engineer_features:210 - Features processadas: 447 colunas
2025-08-05 15:08:23 | INFO     | src.utils:__exit__:322 - Engenharia de features executado em 4.26s
2025-08-05 15:08:26 | INFO     | src.data:build_heterogeneous_graph:424 - Grafo criado com 55715 nós
2025-08-05 15:08:26 | INFO     | src.data:build_heterogeneous_graph:425 - Tipos de nós: ['transaction', 'user', 'card', 'device']
2025-08-05 15:08:26 | INFO     | src.data:build_heterogeneous_graph:426 - Tipos de arestas: [('user', 'makes', 'transaction'), ('transaction', 'uses', 'card'), ('transaction', 'from', 'device')]
2025-08-05 15:08:26 | INFO     | src.utils:__exit__:322 - Construção do grafo executado em 2.33s
2025-08-05 15:08:28 | INFO     | src.data:build_heterogeneous_graph:424 - Grafo criado com 55228 nós
2025-08-05 15:08:28 | INFO     | src.data:build_heterogeneous_graph:425 - Tipos de nós: ['transaction', 'user', 'card', 'device']
2025-08-05 15:08:28 | INFO     | src.data:build_heterogeneous_graph:426 - Tipos de arestas: [('user', 'makes', 'transaction'), ('transaction', 'uses', 'card'), ('transaction', 'from', 'device')]
2025-08-05 15:08:28 | INFO     | src.utils:__exit__:322 - Construção do grafo executado em 2.35s
2025-08-05 15:08:28 | INFO     | src.utils:__exit__:322 - Pipeline completo de dados executado em 17.46s
2025-08-05 15:08:28 | INFO     | main:load_and_process_data:64 - Dados processados: {'loader_info': {'transaction_train_shape': (50000, 394), 'transaction_test_shape': (50000, 393), 'identity_train_shape': (50000, 41), 'identity_test_shape': (50000, 41), 'fraud_rate': 0.02714, 'missing_values': 8247297}, 'train_graph': {'node_types': ['transaction', 'user', 'card', 'device'], 'edge_types': [('user', 'makes', 'transaction'), ('transaction', 'uses', 'card'), ('transaction', 'from', 'device')], 'num_transaction_nodes': 50000, 'num_features': 443, 'fraud_rate': 0.027140000835061073}}
2025-08-05 15:08:28 | INFO     | main:create_model:77 - Detectado grafo heterogêneo, usando modelo HeteroGNN
2025-08-05 15:08:28 | INFO     | src.models:__init__:325 - HeteroGNN construído: SAGE, 3 camadas, dim: 256
2025-08-05 15:08:28 | INFO     | main:create_model:114 - Modelo criado: HeteroGNNModel
2025-08-05 15:08:28 | INFO     | main:create_model:118 - Parâmetros inicializados: 35,458
2025-08-05 15:08:28 | INFO     | src.utils:__exit__:322 - Criação do modelo executado em 0.03s
2025-08-05 15:08:28 | INFO     | src.training:__init__:276 - Trainer inicializado - Dispositivo: cpu
2025-08-05 15:08:28 | INFO     | src.training:__init__:277 - Modelo: HeteroGNNModel
2025-08-05 15:08:28 | INFO     | src.training:__init__:283 - Inicializando parâmetros lazy do HeteroGNN...
2025-08-05 15:08:29 | INFO     | src.training:__init__:287 - Parâmetros lazy inicializados com sucesso
2025-08-05 15:08:29 | INFO     | src.training:__init__:294 - Parâmetros treináveis: 1,047,426
2025-08-05 15:08:29 | INFO     | src.training:train:489 - Iniciando treinamento para 100 épocas
2025-08-05 15:08:30 | INFO     | src.training:train:531 - Época 1/100 - Train Loss: 0.1931 - Val F1: 0.9659 - Val AUC: 0.3680
2025-08-05 15:08:30 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:08:31 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:08:33 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:08:34 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:08:35 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:08:36 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:08:37 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:08:39 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:08:40 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:08:41 | INFO     | src.training:train:531 - Época 10/100 - Train Loss: 0.0668 - Val F1: 0.9659 - Val AUC: 0.6676
2025-08-05 15:08:41 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:08:42 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:08:44 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:08:45 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:08:46 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:08:47 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:08:49 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:08:50 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:08:51 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:08:52 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:08:53 | INFO     | src.training:train:531 - Época 20/100 - Train Loss: 0.0630 - Val F1: 0.9659 - Val AUC: 0.7402
2025-08-05 15:08:53 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:08:55 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:08:56 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:08:57 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:08:59 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:09:00 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:09:01 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:09:03 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:09:04 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:09:05 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:09:06 | INFO     | src.training:train:531 - Época 30/100 - Train Loss: 0.0616 - Val F1: 0.9659 - Val AUC: 0.7577
2025-08-05 15:09:06 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:09:08 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:09:09 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:09:10 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:09:12 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:09:13 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:09:14 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:09:15 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:09:17 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:09:18 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:09:19 | INFO     | src.training:train:531 - Época 40/100 - Train Loss: 0.0618 - Val F1: 0.9659 - Val AUC: 0.7629
2025-08-05 15:09:19 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:09:21 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:09:22 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:09:23 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:09:24 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:09:26 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:09:27 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:09:28 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:09:29 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:09:31 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:09:32 | INFO     | src.training:train:531 - Época 50/100 - Train Loss: 0.0607 - Val F1: 0.9659 - Val AUC: 0.7646
2025-08-05 15:09:32 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:09:33 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:09:34 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:09:36 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:09:37 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:09:39 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:09:40 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:09:41 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:09:43 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:09:44 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:09:45 | INFO     | src.training:train:531 - Época 60/100 - Train Loss: 0.0598 - Val F1: 0.9659 - Val AUC: 0.7652
2025-08-05 15:09:45 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:09:46 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:09:48 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:09:49 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:09:50 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:09:52 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:09:53 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:09:54 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:09:56 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:09:57 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:09:58 | INFO     | src.training:train:531 - Época 70/100 - Train Loss: 0.0604 - Val F1: 0.9659 - Val AUC: 0.7654
2025-08-05 15:09:58 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:10:00 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:10:01 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:10:02 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:10:04 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:10:05 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:10:06 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:10:07 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:10:09 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:10:10 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:10:11 | INFO     | src.training:train:531 - Época 80/100 - Train Loss: 0.0598 - Val F1: 0.9659 - Val AUC: 0.7656
2025-08-05 15:10:11 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:10:12 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:10:14 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:10:15 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:10:16 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:10:18 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:10:19 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:10:20 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:10:22 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:10:23 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:10:24 | INFO     | src.training:train:531 - Época 90/100 - Train Loss: 0.0604 - Val F1: 0.9659 - Val AUC: 0.7658
2025-08-05 15:10:24 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:10:26 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:10:27 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:10:28 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:10:30 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:10:31 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:10:32 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:10:34 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:10:35 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:10:36 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:10:38 | INFO     | src.training:train:531 - Época 100/100 - Train Loss: 0.0607 - Val F1: 0.9659 - Val AUC: 0.7660
2025-08-05 15:10:38 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:10:38 | INFO     | src.utils:__exit__:322 - Treinamento completo (100 épocas) executado em 128.71s
2025-08-05 15:10:38 | INFO     | src.training:train:549 - Melhor modelo carregado (F1: 0.9659)
2025-08-05 15:10:38 | INFO     | src.training:save_model:582 - Modelo salvo em results/models/fraud_detection_model_1754417438.pt
2025-08-05 15:10:38 | INFO     | main:train_model:143 - Treinamento concluído: {'epochs_trained': 100, 'best_epoch': 1, 'best_val_f1': 0.9659314586283634, 'best_val_auc': 0.36803707872833946, 'final_train_loss': 0.06073347106575966, 'final_val_loss': 0.05592568218708038, 'total_parameters': 1047426, 'trainable_parameters': 1047426}
2025-08-05 15:10:38 | INFO     | src.utils:__exit__:322 - Treinamento do modelo executado em 129.44s
2025-08-05 15:10:38 | INFO     | src.utils:__exit__:322 - Avaliação do modelo executado em 0.00s
2025-08-05 15:11:50 | INFO     | src.utils:_load_config:41 - Configuração carregada de config.yaml
2025-08-05 15:11:50 | INFO     | main:__init__:41 - Sistema de detecção de fraude inicializado
2025-08-05 15:11:50 | INFO     | main:__init__:42 - Dispositivo: cpu
2025-08-05 15:11:50 | INFO     | main:setup_data_pipeline:50 - Pipeline de dados configurado
2025-08-05 15:11:50 | INFO     | src.utils:__exit__:322 - Configuração do pipeline de dados executado em 0.00s
2025-08-05 15:11:50 | INFO     | src.data:load_data:88 - Carregando dados de transação...
2025-08-05 15:11:52 | INFO     | src.data:load_data:102 - Carregando dados de identidade...
2025-08-05 15:11:52 | INFO     | src.data:load_data:119 - Dados carregados - Treino: 50000, Teste: 50000
2025-08-05 15:11:52 | INFO     | src.utils:__exit__:322 - Carregamento de dados executado em 2.41s
2025-08-05 15:11:57 | INFO     | src.data:engineer_features:210 - Features processadas: 448 colunas
2025-08-05 15:11:57 | INFO     | src.utils:__exit__:322 - Engenharia de features executado em 5.15s
2025-08-05 15:12:02 | INFO     | src.data:engineer_features:210 - Features processadas: 447 colunas
2025-08-05 15:12:02 | INFO     | src.utils:__exit__:322 - Engenharia de features executado em 4.54s
2025-08-05 15:12:04 | INFO     | src.data:build_heterogeneous_graph:424 - Grafo criado com 55715 nós
2025-08-05 15:12:04 | INFO     | src.data:build_heterogeneous_graph:425 - Tipos de nós: ['transaction', 'user', 'card', 'device']
2025-08-05 15:12:04 | INFO     | src.data:build_heterogeneous_graph:426 - Tipos de arestas: [('user', 'makes', 'transaction'), ('transaction', 'uses', 'card'), ('transaction', 'from', 'device')]
2025-08-05 15:12:04 | INFO     | src.utils:__exit__:322 - Construção do grafo executado em 2.41s
2025-08-05 15:12:07 | INFO     | src.data:build_heterogeneous_graph:424 - Grafo criado com 55228 nós
2025-08-05 15:12:07 | INFO     | src.data:build_heterogeneous_graph:425 - Tipos de nós: ['transaction', 'user', 'card', 'device']
2025-08-05 15:12:07 | INFO     | src.data:build_heterogeneous_graph:426 - Tipos de arestas: [('user', 'makes', 'transaction'), ('transaction', 'uses', 'card'), ('transaction', 'from', 'device')]
2025-08-05 15:12:07 | INFO     | src.utils:__exit__:322 - Construção do grafo executado em 2.39s
2025-08-05 15:12:07 | INFO     | src.utils:__exit__:322 - Pipeline completo de dados executado em 16.89s
2025-08-05 15:12:07 | INFO     | main:load_and_process_data:64 - Dados processados: {'loader_info': {'transaction_train_shape': (50000, 394), 'transaction_test_shape': (50000, 393), 'identity_train_shape': (50000, 41), 'identity_test_shape': (50000, 41), 'fraud_rate': 0.02714, 'missing_values': 8247297}, 'train_graph': {'node_types': ['transaction', 'user', 'card', 'device'], 'edge_types': [('user', 'makes', 'transaction'), ('transaction', 'uses', 'card'), ('transaction', 'from', 'device')], 'num_transaction_nodes': 50000, 'num_features': 443, 'fraud_rate': 0.027140000835061073}}
2025-08-05 15:12:07 | INFO     | main:create_model:77 - Detectado grafo heterogêneo, usando modelo HeteroGNN
2025-08-05 15:12:07 | INFO     | src.models:__init__:325 - HeteroGNN construído: SAGE, 5 camadas, dim: 384
2025-08-05 15:12:07 | INFO     | main:create_model:114 - Modelo criado: HeteroGNNModel
2025-08-05 15:12:07 | INFO     | main:create_model:118 - Parâmetros inicializados: 80,066
2025-08-05 15:12:07 | INFO     | src.utils:__exit__:322 - Criação do modelo executado em 0.01s
2025-08-05 15:12:07 | INFO     | src.training:__init__:276 - Trainer inicializado - Dispositivo: cpu
2025-08-05 15:12:07 | INFO     | src.training:__init__:277 - Modelo: HeteroGNNModel
2025-08-05 15:12:07 | INFO     | src.training:__init__:283 - Inicializando parâmetros lazy do HeteroGNN...
2025-08-05 15:12:08 | INFO     | src.training:__init__:287 - Parâmetros lazy inicializados com sucesso
2025-08-05 15:12:08 | INFO     | src.training:__init__:294 - Parâmetros treináveis: 3,576,386
2025-08-05 15:12:08 | INFO     | src.training:train:489 - Iniciando treinamento para 200 épocas
2025-08-05 15:12:11 | INFO     | src.training:train:531 - Época 1/200 - Train Loss: 0.1551 - Val F1: 0.9659 - Val AUC: 0.5184
2025-08-05 15:12:11 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:12:14 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:12:17 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:12:20 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:12:23 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:12:26 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:12:29 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:12:32 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:12:35 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:12:38 | INFO     | src.training:train:531 - Época 10/200 - Train Loss: 0.0713 - Val F1: 0.9659 - Val AUC: 0.5746
2025-08-05 15:12:38 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:12:41 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:12:44 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:12:48 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:12:51 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:12:54 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:12:57 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:13:00 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:13:03 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:13:06 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:13:09 | INFO     | src.training:train:531 - Época 20/200 - Train Loss: 0.0693 - Val F1: 0.9659 - Val AUC: 0.5913
2025-08-05 15:13:09 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:13:13 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:13:16 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:13:19 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:13:22 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:13:25 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:13:28 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:13:32 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:13:35 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:13:38 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:13:41 | INFO     | src.training:train:531 - Época 30/200 - Train Loss: 0.0665 - Val F1: 0.9659 - Val AUC: 0.6121
2025-08-05 15:13:41 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:13:45 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:13:48 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:13:51 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:13:54 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:13:57 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:14:01 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:14:04 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:14:07 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:14:10 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:14:14 | INFO     | src.training:train:531 - Época 40/200 - Train Loss: 0.0656 - Val F1: 0.9659 - Val AUC: 0.6234
2025-08-05 15:14:14 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:14:17 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:14:20 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:14:23 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:14:27 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:14:30 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:14:33 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:14:36 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:14:40 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:14:43 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:14:46 | INFO     | src.training:train:531 - Época 50/200 - Train Loss: 0.0663 - Val F1: 0.9659 - Val AUC: 0.6274
2025-08-05 15:14:46 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:14:50 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:14:53 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:14:56 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:14:59 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:15:03 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:15:06 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:15:09 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:15:13 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:15:16 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:15:19 | INFO     | src.training:train:531 - Época 60/200 - Train Loss: 0.0670 - Val F1: 0.9659 - Val AUC: 0.6286
2025-08-05 15:15:19 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:15:23 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:15:26 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:15:29 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:15:32 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:15:35 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:15:39 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:15:42 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:15:45 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:15:48 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:15:52 | INFO     | src.training:train:531 - Época 70/200 - Train Loss: 0.0651 - Val F1: 0.9659 - Val AUC: 0.6291
2025-08-05 15:15:52 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:15:55 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:15:58 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:16:02 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:16:05 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:16:08 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:16:11 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:16:15 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:16:18 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:16:21 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:16:24 | INFO     | src.training:train:531 - Época 80/200 - Train Loss: 0.0669 - Val F1: 0.9659 - Val AUC: 0.6295
2025-08-05 15:16:24 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:16:28 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:16:31 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:16:34 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:16:37 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:16:41 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:16:44 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:16:48 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:16:51 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:16:55 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:16:58 | INFO     | src.training:train:531 - Época 90/200 - Train Loss: 0.0664 - Val F1: 0.9659 - Val AUC: 0.6299
2025-08-05 15:16:58 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:17:01 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:17:04 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:17:08 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:17:11 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:17:14 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:17:17 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:17:20 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:17:24 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:17:27 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:17:31 | INFO     | src.training:train:531 - Época 100/200 - Train Loss: 0.0662 - Val F1: 0.9659 - Val AUC: 0.6303
2025-08-05 15:17:31 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:17:34 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:17:38 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:17:41 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:17:45 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:17:48 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:17:51 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:17:55 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:17:58 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:18:02 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:18:05 | INFO     | src.training:train:531 - Época 110/200 - Train Loss: 0.0660 - Val F1: 0.9659 - Val AUC: 0.6308
2025-08-05 15:18:05 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:18:08 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:18:11 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:18:15 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:18:18 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:18:21 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:18:25 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:18:28 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:18:32 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:18:35 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:18:38 | INFO     | src.training:train:531 - Época 120/200 - Train Loss: 0.0659 - Val F1: 0.9659 - Val AUC: 0.6313
2025-08-05 15:18:38 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:18:42 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:18:46 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:18:49 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:18:52 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:18:56 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:18:59 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:19:03 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:19:07 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:19:10 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:19:14 | INFO     | src.training:train:531 - Época 130/200 - Train Loss: 0.0684 - Val F1: 0.9659 - Val AUC: 0.6317
2025-08-05 15:19:14 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:19:17 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:19:20 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:19:23 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:19:26 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:19:30 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:19:33 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:19:37 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:19:40 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:19:44 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:19:47 | INFO     | src.training:train:531 - Época 140/200 - Train Loss: 0.0663 - Val F1: 0.9659 - Val AUC: 0.6321
2025-08-05 15:19:47 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:19:50 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:19:53 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:19:57 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:20:00 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:20:03 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:20:07 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:20:10 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:20:14 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:20:17 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:20:21 | INFO     | src.training:train:531 - Época 150/200 - Train Loss: 0.0660 - Val F1: 0.9659 - Val AUC: 0.6324
2025-08-05 15:20:21 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:20:24 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:20:27 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:20:31 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:20:34 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:20:37 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:20:41 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:20:44 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:20:48 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:20:51 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:20:55 | INFO     | src.training:train:531 - Época 160/200 - Train Loss: 0.0654 - Val F1: 0.9659 - Val AUC: 0.6328
2025-08-05 15:20:55 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:20:58 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:21:02 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:21:05 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:21:09 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:21:12 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:21:15 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:21:19 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:21:22 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:21:26 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:21:29 | INFO     | src.training:train:531 - Época 170/200 - Train Loss: 0.0662 - Val F1: 0.9659 - Val AUC: 0.6332
2025-08-05 15:21:29 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:21:32 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:21:35 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:21:39 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:21:43 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:21:46 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:21:50 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:21:53 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:21:57 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:22:00 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:22:04 | INFO     | src.training:train:531 - Época 180/200 - Train Loss: 0.0643 - Val F1: 0.9659 - Val AUC: 0.6336
2025-08-05 15:22:04 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:22:07 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:22:11 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:22:14 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:22:17 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:22:21 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:22:24 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:22:28 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:22:31 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:22:34 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:22:37 | INFO     | src.training:train:531 - Época 190/200 - Train Loss: 0.0647 - Val F1: 0.9659 - Val AUC: 0.6339
2025-08-05 15:22:37 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:22:40 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:22:43 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:22:46 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:22:50 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:22:53 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:22:56 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:22:59 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:23:03 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:23:06 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:23:09 | INFO     | src.training:train:531 - Época 200/200 - Train Loss: 0.0657 - Val F1: 0.9659 - Val AUC: 0.6343
2025-08-05 15:23:09 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:23:09 | INFO     | src.utils:__exit__:322 - Treinamento completo (200 épocas) executado em 660.85s
2025-08-05 15:23:09 | INFO     | src.training:train:549 - Melhor modelo carregado (F1: 0.9659)
2025-08-05 15:23:09 | INFO     | src.training:save_model:582 - Modelo salvo em results/models/fraud_detection_model_1754418189.pt
2025-08-05 15:23:09 | INFO     | main:train_model:143 - Treinamento concluído: {'epochs_trained': 200, 'best_epoch': 1, 'best_val_f1': 0.9659314586283634, 'best_val_auc': 0.5184179557058837, 'final_train_loss': 0.06565582007169724, 'final_val_loss': 0.06269410997629166, 'total_parameters': 3576386, 'trainable_parameters': 3576386}
2025-08-05 15:23:09 | INFO     | src.utils:__exit__:322 - Treinamento do modelo executado em 662.71s
2025-08-05 15:23:09 | INFO     | src.utils:__exit__:322 - Avaliação do modelo executado em 0.00s
2025-08-05 15:23:34 | INFO     | src.utils:_load_config:41 - Configuração carregada de config.yaml
2025-08-05 15:23:34 | INFO     | main:__init__:41 - Sistema de detecção de fraude inicializado
2025-08-05 15:23:34 | INFO     | main:__init__:42 - Dispositivo: cpu
2025-08-05 15:23:34 | INFO     | main:setup_data_pipeline:50 - Pipeline de dados configurado
2025-08-05 15:23:34 | INFO     | src.utils:__exit__:322 - Configuração do pipeline de dados executado em 0.00s
2025-08-05 15:23:34 | INFO     | src.data:load_data:88 - Carregando dados de transação...
2025-08-05 15:23:36 | INFO     | src.data:load_data:102 - Carregando dados de identidade...
2025-08-05 15:23:36 | INFO     | src.data:load_data:119 - Dados carregados - Treino: 50000, Teste: 50000
2025-08-05 15:23:36 | INFO     | src.utils:__exit__:322 - Carregamento de dados executado em 1.86s
2025-08-05 15:23:42 | INFO     | src.data:engineer_features:210 - Features processadas: 448 colunas
2025-08-05 15:23:42 | INFO     | src.utils:__exit__:322 - Engenharia de features executado em 5.25s
2025-08-05 15:23:47 | INFO     | src.data:engineer_features:210 - Features processadas: 447 colunas
2025-08-05 15:23:47 | INFO     | src.utils:__exit__:322 - Engenharia de features executado em 4.94s
2025-08-05 15:23:49 | INFO     | src.data:build_heterogeneous_graph:424 - Grafo criado com 55715 nós
2025-08-05 15:23:49 | INFO     | src.data:build_heterogeneous_graph:425 - Tipos de nós: ['transaction', 'user', 'card', 'device']
2025-08-05 15:23:49 | INFO     | src.data:build_heterogeneous_graph:426 - Tipos de arestas: [('user', 'makes', 'transaction'), ('transaction', 'uses', 'card'), ('transaction', 'from', 'device')]
2025-08-05 15:23:49 | INFO     | src.utils:__exit__:322 - Construção do grafo executado em 2.68s
2025-08-05 15:23:52 | INFO     | src.data:build_heterogeneous_graph:424 - Grafo criado com 55228 nós
2025-08-05 15:23:52 | INFO     | src.data:build_heterogeneous_graph:425 - Tipos de nós: ['transaction', 'user', 'card', 'device']
2025-08-05 15:23:52 | INFO     | src.data:build_heterogeneous_graph:426 - Tipos de arestas: [('user', 'makes', 'transaction'), ('transaction', 'uses', 'card'), ('transaction', 'from', 'device')]
2025-08-05 15:23:52 | INFO     | src.utils:__exit__:322 - Construção do grafo executado em 2.53s
2025-08-05 15:23:52 | INFO     | src.utils:__exit__:322 - Pipeline completo de dados executado em 17.26s
2025-08-05 15:23:52 | INFO     | main:load_and_process_data:64 - Dados processados: {'loader_info': {'transaction_train_shape': (50000, 394), 'transaction_test_shape': (50000, 393), 'identity_train_shape': (50000, 41), 'identity_test_shape': (50000, 41), 'fraud_rate': 0.02714, 'missing_values': 8247297}, 'train_graph': {'node_types': ['transaction', 'user', 'card', 'device'], 'edge_types': [('user', 'makes', 'transaction'), ('transaction', 'uses', 'card'), ('transaction', 'from', 'device')], 'num_transaction_nodes': 50000, 'num_features': 443, 'fraud_rate': 0.027140000835061073}}
2025-08-05 15:23:52 | INFO     | main:create_model:77 - Detectado grafo heterogêneo, usando modelo HeteroGNN
2025-08-05 15:23:52 | INFO     | src.models:__init__:325 - HeteroGNN construído: SAGE, 5 camadas, dim: 384
2025-08-05 15:23:52 | INFO     | main:create_model:114 - Modelo criado: HeteroGNNModel
2025-08-05 15:23:52 | INFO     | main:create_model:118 - Parâmetros inicializados: 80,066
2025-08-05 15:23:52 | INFO     | src.utils:__exit__:322 - Criação do modelo executado em 0.01s
2025-08-05 15:23:52 | INFO     | src.training:__init__:276 - Trainer inicializado - Dispositivo: cpu
2025-08-05 15:23:52 | INFO     | src.training:__init__:277 - Modelo: HeteroGNNModel
2025-08-05 15:23:52 | INFO     | src.training:__init__:283 - Inicializando parâmetros lazy do HeteroGNN...
2025-08-05 15:23:54 | INFO     | src.training:__init__:287 - Parâmetros lazy inicializados com sucesso
2025-08-05 15:23:54 | INFO     | src.training:__init__:294 - Parâmetros treináveis: 3,576,386
2025-08-05 15:23:54 | INFO     | src.training:train:489 - Iniciando treinamento para 200 épocas
2025-08-05 15:23:57 | INFO     | src.training:train:531 - Época 1/200 - Train Loss: 0.1143 - Val F1: 0.9659 - Val AUC: 0.4939
2025-08-05 15:23:57 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:24:01 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:24:04 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:24:07 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:27:19 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:27:23 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:27:27 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:27:31 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
2025-08-05 15:27:34 | WARNING  | src.training:__call__:194 - Métrica val_f1 não encontrada
